<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Dodgers">
  <meta name="theme-color" content="#001331">
  <title>Los Angeles - Dodgers</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --white:  #FFFFFF;
      --silver: #C0C8D8;
      --sb-width: 280px;
      /* Team color variables — updated dynamically when team changes */
      --team-bg1: #002580;
      --team-bg2: #000D3A;
      --team-bg3: #000510;
      --team-header1: #001E62;
      --team-header2: #003DA5;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      background: radial-gradient(ellipse at 50% 30%, var(--team-bg1) 0%, var(--team-bg2) 55%, var(--team-bg3) 100%);
      font-family: 'Inter', sans-serif;
      color: var(--white);
      transition: background 0.4s ease;
    }
    /* Pinstripe overlay */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: repeating-linear-gradient(
        90deg,
        transparent,
        transparent 28px,
        rgba(255,255,255,0.025) 28px,
        rgba(255,255,255,0.025) 29px
      );
      pointer-events: none;
      z-index: 0;
    }

    /* Field glow at bottom */
    body::after {
      content: '';
      position: fixed;
      bottom: -80px; left: 50%;
      transform: translateX(-50%);
      width: 800px; height: 220px;
      background: radial-gradient(ellipse, rgba(0,80,30,0.25) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .opening-day-bar {
      width: 100%;
      background:
        repeating-linear-gradient(90deg, transparent, transparent 28px, rgba(255,255,255,0.025) 28px, rgba(255,255,255,0.025) 29px),
        linear-gradient(90deg, var(--team-header1) 0%, var(--team-header2) 50%, var(--team-header1) 100%);
      transition: background 0.4s ease;
      border-bottom: 1px solid rgba(255,255,255,0.14);
      padding: 0.7rem 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      font-family: 'Inter', sans-serif;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .bar-logo {
      height: 44px;
      width: auto;
      filter: drop-shadow(0 0 6px rgba(0,61,165,0.7));
    }
    .bar-label {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2rem;
      letter-spacing: 0.1em;
      color: #fff;
      white-space: nowrap;
    }
    .bar-countdown {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2.4rem;
      color: #fff;
      letter-spacing: 0.05em;
    }
    .bar-unit {
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1;
    }
    .bar-val {
      font-size: 2.4rem;
      min-width: 2ch;
      text-align: center;
    }
    .bar-lbl {
      font-family: 'Inter', sans-serif;
      font-size: 0.6rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.5);
      margin-top: 2px;
    }
    .bar-sep { color: rgba(255,255,255,0.3); font-size: 2rem; margin-bottom: 10px; }
    .bar-dot {
      width: 10px; height: 10px;
      background: #FFFFFF;
      border-radius: 50%;
      animation: bardot 1.8s ease infinite;
      flex-shrink: 0;
    }
    @keyframes bardot {
      0%,100% { opacity: 1; }
      50%      { opacity: 0.3; }
    }
    .bar-link {
      text-decoration: none;
      font-family: 'Inter', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      color: rgba(255,255,255,0.45);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      white-space: nowrap;
      transition: color 0.2s;
    }
    .bar-link:hover { color: rgba(255,255,255,0.85); }
    .bar-team-info {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.05rem;
    }
    .bar-team-name {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.7rem;
      letter-spacing: 0.1em;
      color: #fff;
      line-height: 1;
    }
    .bar-team-sub {
      font-size: 0.58rem;
      font-weight: 700;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.35);
    }
    /* ── Fixed left sidebar ──────────────────────────────── */
    :root { --rn-width: 195px; }
    .fixed-sidebar {
      position: fixed;
      top: 72px;
      left: 0;
      bottom: 0;
      width: var(--sb-width);
      z-index: 50;
      overflow-y: auto;
      scrollbar-width: none;
      padding: 1.5rem 1.1rem;
      display: flex;
      flex-direction: column;
      gap: 0.85rem;
      background: rgba(0,4,20,0.52);
      border-right: 1px solid rgba(255,255,255,0.07);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
    }
    .fixed-sidebar::-webkit-scrollbar { display: none; }
    /* Right navigation panel */
    .right-nav {
      position: fixed;
      top: 72px;
      right: 0;
      bottom: 0;
      width: var(--rn-width);
      z-index: 50;
      display: flex;
      flex-direction: column;
      background: rgba(0,4,20,0.52);
      border-left: 1px solid rgba(255,255,255,0.07);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
      padding: 1.2rem 0;
    }
    .rn-label {
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      color: rgba(255,255,255,0.2);
      text-transform: uppercase;
      padding: 0 1rem 0.6rem;
    }
    .rn-item {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.65rem 1rem;
      border: none;
      background: none;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 500;
      color: rgba(255,255,255,0.4);
      text-align: left;
      width: 100%;
      border-left: 2px solid transparent;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      -webkit-tap-highlight-color: transparent;
    }
    .rn-item:hover { color: rgba(255,255,255,0.75); background: rgba(255,255,255,0.04); }
    .rn-item.active { color: #fff; border-left-color: var(--team-header2, #003DA5); background: rgba(255,255,255,0.06); }
    .rn-badge {
      font-size: 0.5rem; font-weight: 700; letter-spacing: 0.1em;
      background: #e53; color: #fff; border-radius: 4px; padding: 1px 4px;
    }
    /* ── Main content (offset for both sidebars) ──────────────── */
    .main-content {
      margin-left: var(--sb-width);
      margin-right: var(--rn-width);
    }
    /* When left sidebar is hidden (non-home views) */
    body.no-left-sidebar .fixed-sidebar { display: none; }
    body.no-left-sidebar .main-content  { margin-left: 0; }
    .dash-label {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.32);
    }
    .stats-divider { opacity: 0.3; }
    /* legacy — no longer used as layout */
    .stats-panel, .stats-inner, .dash-grid {
      gap: 1.25rem;
      align-items: flex-start;
    }
    .dash-card {
      background: rgba(255,255,255,0.035);
      border: 1px solid rgba(255,255,255,0.07);
      border-radius: 10px;
      padding: 0.9rem 0.85rem;
    }
    .dash-card-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 0.9rem;
    }
    .dash-card-label {
      font-size: 0.62rem;
      font-weight: 700;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.35);
    }
    .dash-card-sub {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.28);
      letter-spacing: 0.06em;
    }

    /* Team stats grid */
    .team-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0;
    }
    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      padding: 0.85rem 0.4rem;
      border-right: 1px solid rgba(255,255,255,0.06);
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .stat-item:nth-child(2n) { border-right: none; }
    .stat-item:nth-last-child(-n+2) { border-bottom: none; }
    .stat-val {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.55rem;
      letter-spacing: 0.03em;
      color: #fff;
      line-height: 1;
    }
    .stat-lbl {
      font-size: 0.54rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.4);
      white-space: nowrap;
      text-align: center;
    }
    .stat-rank {
      font-size: 0.48rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.22);
      white-space: nowrap;
    }

    /* Last game score */
    .lg-score {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      padding: 0.9rem 0 1.1rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      margin-bottom: 1rem;
    }
    .lgs-side {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }
    .lgs-abbr {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1rem;
      letter-spacing: 0.18em;
      color: rgba(255,255,255,0.38);
    }
    .lgs-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2.8rem;
      color: #fff;
      line-height: 1;
      letter-spacing: -0.02em;
    }
    .lgs-sep {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2rem;
      color: rgba(255,255,255,0.15);
    }

    /* Performers */
    .performers-label {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      margin-bottom: 0.5rem;
      padding-top: 0.25rem;
    }
    .performers {
      display: flex;
      flex-direction: column;
      gap: 0;
    }
    .performer {
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
      padding: 0.55rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .performer:last-child { border-bottom: none; }
    .p-name {
      font-family: 'Inter', sans-serif;
      font-size: 0.88rem;
      font-weight: 600;
      letter-spacing: 0.01em;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .p-line {
      font-size: 0.7rem;
      font-weight: 400;
      letter-spacing: 0.03em;
      color: rgba(255,255,255,0.42);
    }

    .news-section-label {
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.32);
      margin-bottom: 1.1rem;
      display: block;
    }
    .news-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }
    .news-card {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      overflow: hidden;
      text-decoration: none;
      color: #fff;
      display: flex;
      flex-direction: column;
      transition: background 0.2s, border-color 0.2s;
      cursor: pointer;
    }
    .news-card:hover {
      background: rgba(255,255,255,0.055);
      border-color: rgba(255,255,255,0.15);
    }
    .news-card-img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      display: block;
      background: rgba(0,30,80,0.5);
    }
    .news-card-body {
      padding: 1rem 1.1rem 1.15rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .news-card-headline {
      font-size: 0.88rem;
      font-weight: 600;
      line-height: 1.4;
      color: #fff;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .news-card-meta {
      font-size: 0.62rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      margin-top: auto;
    }
    .news-loading {
      grid-column: 1/-1;
      padding: 2.5rem 0;
      text-align: center;
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.18);
    }
    /* ── Mobile App Layout ─────────────────────────────── */
    .mob-tabs { display: none; }

    @media (max-width: 700px) {
      :root { --sb-width: 0px; --rn-width: 0px; }

      /* Both sidebars off on mobile */
      .fixed-sidebar { display: none; }
      .right-nav     { display: none; }
      .main-content  { margin-left: 0; margin-right: 0; }

      /* ── Header: compact iOS nav bar feel ── */
      .opening-day-bar {
        padding: calc(0.55rem + env(safe-area-inset-top, 0px)) 1rem 0.55rem;
        gap: 0.75rem;
        justify-content: flex-start;
      }
      .bar-logo      { height: 36px; }
      .bar-team-name { font-size: 1.4rem; }
      .bar-team-sub  { font-size: 0.52rem; }
      .bar-actions   { right: 0.75rem; gap: 0.25rem; }
      .settings-btn  { padding: 0.3rem 0.5rem; font-size: 1.1rem; }
      .team-switcher-btn img { height: 22px; }

      /* Hide hamburger — tab bar takes over */
      .settings-btn[title="Menu"] { display: none; }

      /* Nav menu disabled on mobile */
      .nav-menu { display: none !important; }

      /* Leave room for tab bar at bottom */
      body {
        padding-bottom: calc(58px + env(safe-area-inset-bottom, 0px));
      }

      /* ── Hero section ── */
      #view-home { height: auto; overflow: visible; }
      .hero-section {
        min-height: calc(100dvh - 60px - 58px - env(safe-area-inset-top, 0px) - env(safe-area-inset-bottom, 0px));
        height: auto;
        padding: 1.5rem 1.25rem 1rem;
        gap: 0.7rem;
      }
      .hero-logo      { height: clamp(75px, 26vw, 120px) !important; }
      .hero-city      { font-size: clamp(0.75rem, 4.5vw, 1.2rem) !important;
                        letter-spacing: 0.18em !important; }
      .hero-team-name { font-size: clamp(2.8rem, 18vw, 5rem) !important; }
      .hero-champs    { font-size: 0.58rem !important;
                        letter-spacing: 0.1em !important;
                        padding: 0.28rem 0.8rem !important;
                        margin-top: 0.4rem !important; }
      .hero-scroll    { display: none; }
      .hero-wordmark  { gap: 0; }

      /* ── WS banners — horizontal scroll row ── */
      .ws-banners {
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        justify-content: flex-start !important;
        padding: 0 0 4px;
        width: 100%;
      }
      .ws-banners::-webkit-scrollbar { display: none; }
      .ws-banner { width: 30px; height: 54px; flex-shrink: 0; }
      .ws-banner-year { font-size: 0.62rem; }

      /* ── Side panel: full-screen, no inner tabs ── */
      .side-panel { width: 100%; top: 0; }

      /* Hide WS banners on mobile */
      .ws-banners { display: none !important; }

      /* ── Depth chart ── */
      .dc-grid       { grid-template-columns: repeat(2, 1fr); gap: 0.5rem; }
      .dc-wrap       { padding: 1rem 0.75rem 2rem; }
      .dc-page-title { font-size: 1.5rem; }
      .dc-section-label { margin-top: 1.25rem; }

      /* ── Live game view ── */
      .live-full { padding: 0.75rem 0.75rem 2rem; }

      /* ── Bottom tab bar ── */
      .mob-tabs {
        display: flex;
        position: fixed;
        bottom: 0; left: 0; right: 0;
        height: calc(58px + env(safe-area-inset-bottom, 0px));
        padding-bottom: env(safe-area-inset-bottom, 0px);
        background: rgba(0, 7, 32, 0.97);
        backdrop-filter: blur(28px);
        -webkit-backdrop-filter: blur(28px);
        border-top: 0.5px solid rgba(255,255,255,0.1);
        z-index: 350;
      }
      .mob-tab {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px 2px 4px;
        color: rgba(255,255,255,0.32);
        position: relative;
        gap: 4px;
        -webkit-tap-highlight-color: transparent;
        transition: color 0.12s;
      }
      .mob-tab.active  { color: #fff; }
      .mob-tab:active  { opacity: 0.6; }
      .mob-tab svg     { width: 22px; height: 22px; flex-shrink: 0; }
      .mob-tab-label {
        font-family: 'Inter', sans-serif;
        font-size: 0.57rem;
        font-weight: 500;
        letter-spacing: 0.01em;
        line-height: 1;
      }
      .mob-live-dot {
        position: absolute;
        top: 5px;
        right: calc(50% - 18px);
        width: 8px; height: 8px;
        background: #ff3b30;
        border-radius: 50%;
        border: 1.5px solid rgba(0,7,32,0.97);
        animation: livepulse 1.4s ease-in-out infinite;
      }
    }

    /* ── Side Panel ─────────────────────────────────────── */
    .panel-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      z-index: 290;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.28s ease;
    }
    .panel-backdrop.open { opacity: 1; pointer-events: all; }

    .side-panel {
      position: fixed;
      right: 0;
      top: 0;
      height: 100dvh;
      width: 340px;
      background:
        repeating-linear-gradient(90deg, transparent, transparent 28px, rgba(255,255,255,0.018) 28px, rgba(255,255,255,0.018) 29px),
        linear-gradient(160deg, #001850 0%, #000C30 60%, #000510 100%);
      border-left: 1px solid rgba(255,255,255,0.1);
      z-index: 300;
      transform: translateX(100%);
      transition: transform 0.28s ease;
      display: flex;
      flex-direction: column;
    }
    .side-panel.open { transform: translateX(0); }

    .sp-header {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.9rem 1.25rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      flex-shrink: 0;
    }
    .sp-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.9rem;
      letter-spacing: 0.2em;
      color: rgba(255,255,255,0.4);
      flex: 1;
    }
    .sp-close {
      background: none;
      border: none;
      color: rgba(255,255,255,0.35);
      font-size: 1.1rem;
      cursor: pointer;
      line-height: 1;
      padding: 0.2rem;
      transition: color 0.15s;
    }
    .sp-close:hover { color: #fff; }

    .sp-tabs {
      display: none;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      padding: 0 1.25rem;
      flex-shrink: 0;
    }
    .sp-tab {
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      padding: 0.6rem 0.8rem;
      margin-bottom: -1px;
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.9rem;
      letter-spacing: 0.1em;
      color: rgba(255,255,255,0.3);
      cursor: pointer;
      transition: color 0.15s, border-color 0.15s;
    }
    .sp-tab:first-child { padding-left: 0; }
    .sp-tab:hover { color: rgba(255,255,255,0.7); }
    .sp-tab.active { color: #fff; border-bottom-color: rgba(255,255,255,0.6); }

    .sp-body {
      flex: 1;
      overflow-y: auto;
      padding: 0.5rem 1.25rem 2rem;
    }
    .sp-panel { display: none; }
    .sp-panel.active { display: block; }

    /* ── Schedule filter button + sheet ──────────────── */
    .filter-trigger-btn {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 7px;
      padding: 0.3rem 0.7rem;
      color: rgba(255,255,255,0.5);
      font-family: 'Inter', sans-serif;
      font-size: 0.72rem;
      font-weight: 500;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      transition: background 0.15s, color 0.15s;
    }
    .filter-trigger-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
    .filter-trigger-btn.has-filters {
      background: rgba(0,50,160,0.35);
      border-color: rgba(0,100,255,0.4);
      color: #fff;
    }
    .filter-badge {
      background: #003DA5;
      color: #fff;
      font-size: 0.58rem;
      font-weight: 700;
      border-radius: 10px;
      padding: 1px 5px;
      min-width: 16px;
      text-align: center;
      line-height: 1.4;
    }
    .sched-filter-sheet {
      flex-shrink: 0;
      background: rgba(0,6,32,0.98);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      padding: 0.85rem 1.25rem 1rem;
    }
    .sched-check-group-label {
      font-size: 0.56rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.25);
      margin-bottom: 0.3rem;
    }
    .sched-check-group-label + .sched-check-group-label,
    .sched-check-gap { margin-top: 0.65rem; }
    .sched-check-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.42rem 0;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .sched-check-row input[type="checkbox"] { display: none; }
    .sched-check-box {
      width: 19px;
      height: 19px;
      border: 1.5px solid rgba(255,255,255,0.22);
      border-radius: 5px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, border-color 0.15s;
    }
    .sched-check-row input:checked ~ .sched-check-box {
      background: #003DA5;
      border-color: #003DA5;
    }
    .sched-check-row input:checked ~ .sched-check-box::after {
      content: '';
      display: block;
      width: 5px;
      height: 9px;
      border: 2px solid #fff;
      border-top: none;
      border-left: none;
      transform: rotate(45deg) translate(-1px, -1px);
    }
    .sched-check-label {
      font-family: 'Inter', sans-serif;
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
      transition: color 0.12s;
    }
    .sched-check-row input:checked ~ .sched-check-label { color: #fff; }
    .filter-sheet-actions {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.9rem;
    }
    .filter-clear-btn {
      flex: 1;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 0.5rem;
      color: rgba(255,255,255,0.5);
      font-family: 'Inter', sans-serif;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
    }
    .filter-clear-btn:hover { background: rgba(255,255,255,0.1); color: #fff; }
    .filter-done-btn {
      flex: 1;
      background: #003DA5;
      border: none;
      border-radius: 8px;
      padding: 0.5rem;
      color: #fff;
      font-family: 'Inter', sans-serif;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.15s;
    }
    .filter-done-btn:hover { opacity: 0.85; }

    /* ── Schedule rows ───────────────────────────────── */
    .schedule-list { display: flex; flex-direction: column; }
    .schedule-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.6rem 1.25rem;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      cursor: pointer;
      transition: background 0.12s;
      -webkit-tap-highlight-color: transparent;
    }
    .schedule-row:last-child { border-bottom: none; }
    .schedule-row:hover, .schedule-row:active { background: rgba(255,255,255,0.04); }
    .sr-chevron {
      color: rgba(255,255,255,0.2);
      font-size: 0.85rem;
      flex-shrink: 0;
      margin-left: auto;
    }

    /* ── Game detail view ────────────────────────────── */
    .game-detail {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .gd-back {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.75rem 1.25rem;
      background: none;
      border: none;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.5);
      font-family: 'Inter', sans-serif;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      transition: color 0.12s;
      text-align: left;
      width: 100%;
      flex-shrink: 0;
    }
    .gd-back:hover { color: #fff; }
    .gd-scroll { flex: 1; overflow-y: auto; padding: 1.5rem 1.25rem 2rem; }
    .gd-date-label {
      font-size: 0.62rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.35);
      margin-bottom: 1.25rem;
    }
    .gd-matchup {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }
    .gd-team {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      flex: 1;
    }
    .gd-team-logo {
      height: 52px;
      width: auto;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
    }
    .gd-team-name {
      font-size: 0.68rem;
      font-weight: 600;
      color: rgba(255,255,255,0.65);
      text-align: center;
      line-height: 1.2;
    }
    .gd-vs {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.4rem;
      color: rgba(255,255,255,0.2);
      flex-shrink: 0;
    }
    .gd-info-grid {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
      margin-bottom: 1.75rem;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 10px;
      padding: 1rem 1.1rem;
    }
    .gd-info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
    }
    .gd-info-label {
      color: rgba(255,255,255,0.35);
      font-size: 0.68rem;
    }
    .gd-info-val { color: #fff; font-weight: 500; }
    .gd-tickets-btn {
      display: block;
      width: 100%;
      padding: 0.85rem;
      background: linear-gradient(135deg, #003DA5 0%, #0052cc 100%);
      border: none;
      border-radius: 10px;
      color: #fff;
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.2rem;
      letter-spacing: 0.1em;
      text-align: center;
      text-decoration: none;
      cursor: pointer;
      transition: opacity 0.15s;
      -webkit-tap-highlight-color: transparent;
    }
    .gd-tickets-btn:hover { opacity: 0.85; }
    .gd-no-tickets {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.25);
      text-align: center;
      margin-top: 0.6rem;
    }
    .sr-date {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-width: 44px;
      flex-shrink: 0;
    }
    .sr-day {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
    }
    .sr-monthday {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.95rem;
      letter-spacing: 0.04em;
      color: rgba(255,255,255,0.75);
      line-height: 1.1;
    }
    .sr-logo { height: 24px; width: auto; flex-shrink: 0; }
    .sr-opponent {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .sr-opp-info { display: flex; align-items: baseline; gap: 0.3rem; }
    .sr-at-vs {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
    }
    .sr-name { font-size: 0.78rem; font-weight: 600; color: #fff; }
    .sr-time {
      font-size: 0.65rem;
      color: rgba(255,255,255,0.38);
      flex-shrink: 0;
      white-space: nowrap;
    }
    .roster-placeholder {
      padding: 3rem 0;
      text-align: center;
      font-size: 0.68rem;
      font-weight: 700;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.15);
    }
    .roster-group { margin-top: 0.75rem; }
    .roster-group:first-child { margin-top: 0.25rem; }
    .roster-group-title {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.22);
      padding: 0.5rem 0 0.3rem;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .roster-row {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.38rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .roster-row:last-child { border-bottom: none; }
    .roster-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.85rem;
      color: rgba(255,255,255,0.35);
      min-width: 20px;
      text-align: right;
      flex-shrink: 0;
    }
    .roster-name { font-size: 0.75rem; font-weight: 600; color: #fff; flex: 1; }
    .roster-pos {
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      color: rgba(255,255,255,0.28);
      flex-shrink: 0;
    }

    /* ── Player Detail View (legacy, unused) ──────────── */
    .pd-body { flex: 1; overflow-y: auto; padding: 0.75rem 1.25rem 2rem; }
    .pd-section { margin-bottom: 2rem; }
    .pd-section-title {
      font-size: 0.6rem;
      font-weight: 700;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      padding-bottom: 0.7rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      margin-bottom: 1rem;
    }
    .pd-stat-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
    }
    .pd-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.85rem 0.25rem;
      border-right: 1px solid rgba(255,255,255,0.05);
      border-bottom: 1px solid rgba(255,255,255,0.05);
      gap: 0.15rem;
    }
    .pd-stat:nth-child(4n) { border-right: none; }
    .pd-stat-val {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2rem;
      letter-spacing: 0.02em;
      color: #fff;
      line-height: 1;
    }
    .pd-stat-lbl {
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.38);
      margin-top: 0.2rem;
    }
    .pd-loading {
      padding: 3rem 0;
      text-align: center;
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.18);
    }
    .pd-back {
      background: none;
      border: none;
      color: rgba(255,255,255,0.4);
      font-size: 0.72rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      cursor: pointer;
      padding: 0;
      transition: color 0.15s;
    }
    .pd-back:hover { color: #fff; }
    .roster-row { cursor: pointer; transition: opacity 0.15s; }
    .roster-row:hover { opacity: 0.72; }
    .roster-chevron {
      color: rgba(255,255,255,0.2);
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    /* ── Settings Button & Team Dropdown ────────────────── */
    .bar-actions {
      position: absolute;
      right: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    /* ── Settings gear button ─────────────────────────────── */
    .settings-icon-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      color: rgba(255,255,255,0.55);
      cursor: pointer;
      padding: 0.35rem;
      border-radius: 7px;
      transition: color 0.15s, background 0.15s;
      -webkit-tap-highlight-color: transparent;
    }
    .settings-icon-btn:hover { color: #fff; background: rgba(255,255,255,0.1); }
    .settings-icon-btn.open   { color: #fff; background: rgba(255,255,255,0.12); }

    /* ── Settings dropdown ────────────────────────────────── */
    .settings-dropdown {
      position: absolute;
      top: calc(100% + 6px);
      right: 0.75rem;
      width: 230px;
      background: rgba(4,10,38,0.97);
      backdrop-filter: blur(28px);
      -webkit-backdrop-filter: blur(28px);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 13px;
      padding: 0.45rem;
      z-index: 300;
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
      opacity: 0;
      pointer-events: none;
      transform: translateY(-6px) scale(0.97);
      transform-origin: top right;
      transition: opacity 0.18s ease, transform 0.18s ease;
    }
    .settings-dropdown.open {
      opacity: 1;
      pointer-events: all;
      transform: translateY(0) scale(1);
    }
    .sdrop-section-label {
      font-size: 0.56rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      padding: 0.35rem 0.7rem 0.25rem;
    }
    .sdrop-team-row {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      width: 100%;
      padding: 0.55rem 0.7rem;
      background: none;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.65);
      font-size: 0.83rem;
      font-weight: 500;
      font-family: 'Inter', sans-serif;
      text-align: left;
      transition: background 0.13s, color 0.13s;
      -webkit-tap-highlight-color: transparent;
    }
    .sdrop-team-row:hover { background: rgba(255,255,255,0.07); color: #fff; }
    .sdrop-team-row.active { color: #fff; }
    .sdrop-team-row img { width: 26px; height: 26px; object-fit: contain; border-radius: 4px; }
    .sdrop-check {
      margin-left: auto;
      color: var(--team-header2, #003DA5);
      font-size: 1rem;
      font-weight: 700;
    }
    .sdrop-divider {
      height: 1px;
      background: rgba(255,255,255,0.08);
      margin: 0.35rem 0;
    }
    .sdrop-save-btn {
      display: flex;
      align-items: center;
      gap: 0.55rem;
      width: 100%;
      padding: 0.55rem 0.7rem;
      background: none;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.45);
      font-size: 0.78rem;
      font-weight: 600;
      font-family: 'Inter', sans-serif;
      transition: background 0.13s, color 0.13s;
      -webkit-tap-highlight-color: transparent;
    }
    .sdrop-save-btn:hover { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.8); }
    .sdrop-saved-msg {
      text-align: center;
      font-size: 0.7rem;
      font-weight: 600;
      color: rgba(80,210,120,0.9);
      padding: 0.25rem 0.7rem 0.3rem;
      letter-spacing: 0.04em;
    }
    /* Keep old CSS names for any residual references */
    .team-dropdown-item {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      padding: 0.65rem 1rem;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
      font-size: 0.8rem;
      font-weight: 600;
      color: rgba(255,255,255,0.65);
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .team-dropdown-item:last-child { border-bottom: none; }
    .team-dropdown-item img { height: 24px; width: auto; }
    .team-dropdown-item:hover { background: rgba(255,255,255,0.07); color: #fff; }
    .team-dropdown-item.active { background: rgba(255,255,255,0.05); color: #fff; }

    /* ── Hero Section ─────────────────────────────────── */
    #view-home {
      height: calc(100dvh - 72px);
      overflow: hidden;
    }
    .hero-section {
      position: relative;
      z-index: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1.5rem 2rem;
      gap: 1.1rem;
    }
    .hero-logo {
      height: clamp(130px, 14vw, 200px);
      width: auto;
      filter: drop-shadow(0 0 40px rgba(0,61,165,0.8)) drop-shadow(0 0 16px rgba(0,100,255,0.4));
      opacity: 0.95;
    }
    /* hero wordmark */
    .hero-wordmark {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      line-height: 1;
    }
    .hero-city {
      font-family: 'Inter', sans-serif;
      font-size: clamp(1.1rem, 3vw, 1.9rem);
      font-weight: 700;
      letter-spacing: 0.5em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.5);
    }
    .hero-team-name {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(4.5rem, 11vw, 8.5rem);
      letter-spacing: 0.08em;
      color: #fff;
      line-height: 0.92;
      text-shadow: 0 0 60px rgba(0,61,165,0.7), 0 0 120px rgba(0,61,165,0.3);
    }
    .hero-champs {
      font-size: clamp(0.58rem, 1.1vw, 0.78rem);
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(220,160,30,0.8);
      border: 1px solid rgba(220,160,30,0.25);
      border-radius: 4px;
      padding: 0.28rem 1rem;
      margin-top: 0.4rem;
    }
    /* ── WS Championship Banners ─────────────────────── */
    .ws-banners {
      display: flex;
      align-items: flex-start;
      gap: 5px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .ws-banner {
      width: 32px;
      height: 57px;
      background: linear-gradient(175deg, #1e44cc 0%, #1830a8 100%);
      clip-path: polygon(3% 0, 97% 0, 100% 4%, 100% 78%, 50% 100%, 0 78%, 0 4%);
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 9px;
      filter: drop-shadow(0 0 2px rgba(180,140,20,0.85)) drop-shadow(0 0 1px rgba(180,140,20,0.6));
      transition: filter 0.2s, transform 0.2s;
      cursor: pointer;
    }
    .ws-banner:hover {
      filter: drop-shadow(0 0 5px rgba(220,170,30,1)) drop-shadow(0 0 2px rgba(220,170,30,0.8));
      transform: translateY(-3px);
    }
    .ws-banner-year {
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1rem;
      letter-spacing: 0.1em;
      color: #fff;
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
      user-select: none;
    }

    /* ── Live Game Card ─────────────────────────────── */
    .live-pill {
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-size: 0.48rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      color: rgba(255,80,80,0.9);
    }
    .live-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #ff4444;
      animation: livepulse 1.4s ease-in-out infinite;
      flex-shrink: 0;
    }
    @keyframes livepulse {
      0%,100% { opacity: 1; transform: scale(1); }
      50%      { opacity: 0.4; transform: scale(0.7); }
    }
    .live-score {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      padding: 0.75rem 0 0.85rem;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      margin-bottom: 0.75rem;
    }
    .live-team {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .live-logo {
      height: 22px;
      width: auto;
    }
    .live-abbr {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.9rem;
      letter-spacing: 0.1em;
      color: rgba(255,255,255,0.5);
    }
    .live-runs {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2.2rem;
      line-height: 1;
      color: #fff;
      min-width: 1.2ch;
      text-align: center;
    }
    .live-runs.batting { color: rgba(230,170,40,0.9); }
    .live-inning {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.85rem;
      letter-spacing: 0.08em;
      color: rgba(255,255,255,0.35);
      text-align: center;
      line-height: 1.2;
    }
    .live-details {
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
    }
    .live-bases-count {
      display: flex;
      align-items: center;
      gap: 0.9rem;
    }
    .bases-wrap {
      position: relative;
      width: 52px;
      height: 52px;
      flex-shrink: 0;
    }
    .base {
      position: absolute;
      width: 11px;
      height: 11px;
      border: 1.5px solid rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.06);
      transform: rotate(45deg);
    }
    .base.on {
      background: rgba(230,170,40,0.85);
      border-color: rgba(230,170,40,1);
    }
    .base-2b { top: 2px;  left: 50%; margin-left: -5.5px; }
    .base-1b { right: 2px; top: 50%; margin-top:  -5.5px; }
    .base-3b { left: 2px;  top: 50%; margin-top:  -5.5px; }
    .base-home { bottom: 2px; left: 50%; margin-left: -5.5px; background: rgba(255,255,255,0.04); }
    .count-wrap {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }
    .count-row {
      display: flex;
      align-items: center;
      gap: 0.28rem;
    }
    .count-lbl {
      font-size: 0.48rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      color: rgba(255,255,255,0.3);
      width: 10px;
    }
    .count-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      border: 1.5px solid rgba(255,255,255,0.2);
      background: transparent;
    }
    .count-dot.ball   { background: rgba(100,200,100,0.85); border-color: rgba(100,200,100,1); }
    .count-dot.strike { background: rgba(230,170,40,0.85);  border-color: rgba(230,170,40,1); }
    .count-dot.out    { background: rgba(220,60,40,0.85);   border-color: rgba(220,60,40,1); }
    .live-matchup-row {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .live-role {
      font-size: 0.44rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      background: rgba(255,255,255,0.07);
      border-radius: 3px;
      padding: 0.12rem 0.3rem;
      flex-shrink: 0;
    }
    .live-player {
      font-size: 0.8rem;
      font-weight: 600;
      color: rgba(255,255,255,0.85);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .live-last-play {
      font-size: 0.68rem;
      color: rgba(255,255,255,0.38);
      line-height: 1.5;
      border-top: 1px solid rgba(255,255,255,0.05);
      padding-top: 0.55rem;
      margin-top: 0.1rem;
    }

    /* ── WS Info Modal ───────────────────────────────── */
    .ws-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.78);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: 450;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
    }
    .ws-backdrop.open { opacity: 1; pointer-events: all; }
    .ws-modal {
      position: fixed;
      inset: 0;
      z-index: 460;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      pointer-events: none;
      opacity: 0;
      transform: translateY(18px) scale(0.97);
      transition: opacity 0.28s ease, transform 0.28s ease;
    }
    .ws-modal.open { opacity: 1; transform: none; pointer-events: all; }
    .ws-modal-card {
      background: linear-gradient(155deg, #001a5c 0%, #000b30 55%, #000510 100%);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 18px;
      max-width: 680px;
      width: 100%;
      max-height: 88dvh;
      overflow-y: auto;
      scrollbar-width: none;
      position: relative;
    }
    .ws-modal-card::-webkit-scrollbar { display: none; }
    .ws-modal-header {
      padding: 1.75rem 1.75rem 1.25rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 1rem;
    }
    .ws-modal-year-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 4.5rem;
      line-height: 1;
      color: rgba(230,170,40,0.92);
      letter-spacing: 0.04em;
    }
    .ws-modal-subtitle {
      font-size: 0.72rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      margin-top: 0.35rem;
    }
    .ws-modal-close {
      background: rgba(255,255,255,0.07);
      border: 1px solid rgba(255,255,255,0.08);
      color: rgba(255,255,255,0.45);
      width: 34px;
      height: 34px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, color 0.15s;
      flex-shrink: 0;
      margin-top: 0.25rem;
    }
    .ws-modal-close:hover { background: rgba(255,255,255,0.13); color: #fff; }
    .ws-modal-body {
      display: flex;
      gap: 1.5rem;
      padding: 1.5rem 1.75rem 2rem;
    }
    .ws-modal-img-wrap {
      width: 200px;
      flex-shrink: 0;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(0,20,70,0.6);
      border: 1px solid rgba(255,255,255,0.07);
      aspect-ratio: 3/4;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .ws-modal-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }
    .ws-modal-img-placeholder {
      font-size: 2.5rem;
      opacity: 0.15;
    }
    .ws-modal-details {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .ws-modal-result {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.5rem;
      letter-spacing: 0.06em;
      color: #fff;
      line-height: 1.1;
    }
    .ws-modal-meta {
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
    }
    .ws-modal-meta-row {
      display: flex;
      align-items: baseline;
      gap: 0.6rem;
    }
    .ws-modal-meta-label {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      min-width: 55px;
      flex-shrink: 0;
    }
    .ws-modal-meta-value {
      font-size: 0.82rem;
      color: rgba(255,255,255,0.75);
      font-weight: 500;
    }
    .ws-modal-desc {
      font-size: 0.86rem;
      line-height: 1.7;
      color: rgba(255,255,255,0.5);
      border-top: 1px solid rgba(255,255,255,0.06);
      padding-top: 1rem;
    }
    @media (max-width: 560px) {
      .ws-modal-body { flex-direction: column; }
      .ws-modal-img-wrap { width: 100%; aspect-ratio: 16/9; }
    }
    .hero-countdown {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .hero-unit {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.4rem;
    }
    .hero-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(6rem, 16vw, 11rem);
      line-height: 1;
      letter-spacing: -0.02em;
      color: #fff;
      min-width: 2ch;
      text-align: center;
    }
    .hero-lbl {
      font-family: 'Inter', sans-serif;
      font-size: 0.72rem;
      font-weight: 700;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.32);
    }
    .hero-sep {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(4.5rem, 13vw, 9rem);
      color: rgba(255,255,255,0.12);
      line-height: 1;
      align-self: flex-start;
      margin-top: 0.05em;
    }
    .hero-scroll {
      position: absolute;
      bottom: 1.75rem;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.58rem;
      font-weight: 700;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.22);
      animation: scrollbob 2.2s ease-in-out infinite;
      white-space: nowrap;
    }
    @keyframes scrollbob {
      0%,100% { transform: translateX(-50%) translateY(0); opacity: 0.22; }
      50%      { transform: translateX(-50%) translateY(8px); opacity: 0.45; }
    }

    /* ── Next Game card (lives at bottom of right nav) ──── */
    .hero-next {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      background: rgba(0,30,100,0.3);
      border: 1px solid rgba(255,255,255,0.09);
      border-radius: 10px;
      padding: 0.75rem 0.85rem;
    }
    .hero-next-label {
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
    }
    .hero-next-venue {
      font-size: 0.78rem;
      font-weight: 600;
      color: rgba(255,255,255,0.55);
      letter-spacing: 0.03em;
    }
    .hero-next-matchup {
      display: flex;
      align-items: center;
      gap: 0.55rem;
    }
    .hero-next-logo {
      height: 30px;
      width: auto;
    }
    .hero-next-sep {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1rem;
      letter-spacing: 0.08em;
      color: rgba(255,255,255,0.28);
    }
    .hero-next-team {
      font-size: 0.9rem;
      font-weight: 600;
      color: #fff;
      letter-spacing: 0.01em;
    }
    .hero-next-time {
      font-size: 0.7rem;
      color: rgba(255,255,255,0.38);
      letter-spacing: 0.05em;
    }

    /* ── Player Overlay ──────────────────────────────── */
    .player-overlay {
      position: fixed;
      inset: 0;
      z-index: 400;
      background:
        repeating-linear-gradient(90deg, transparent, transparent 28px, rgba(255,255,255,0.018) 28px, rgba(255,255,255,0.018) 29px),
        linear-gradient(160deg, #001850 0%, #000C30 60%, #000510 100%);
      transform: translateY(100%);
      transition: transform 0.38s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .player-overlay.open { transform: translateY(0); }

    .po-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      flex-shrink: 0;
    }
    .po-back {
      background: none;
      border: none;
      color: rgba(255,255,255,0.4);
      font-size: 0.78rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      cursor: pointer;
      padding: 0;
      transition: color 0.15s;
    }
    .po-back:hover { color: #fff; }
    /* Bottom back bar inside player overlay */
    .po-bottom-bar {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0.75rem 1.5rem calc(0.75rem + env(safe-area-inset-bottom, 0px));
      border-top: 1px solid rgba(255,255,255,0.07);
    }
    .po-bottom-back {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--team-header2, #003DA5);
      border: 3px solid rgba(255,255,255,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      -webkit-tap-highlight-color: transparent;
      transition: opacity 0.15s;
    }
    .po-bottom-back:active { opacity: 0.6; }
    .po-bottom-back img {
      width: 36px;
      height: 36px;
      object-fit: contain;
    }
    .po-team-label {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.8rem;
      letter-spacing: 0.25em;
      color: rgba(255,255,255,0.2);
    }

    /* single scrollable column */
    .po-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 2.5rem 3rem 4rem;
      max-width: 860px;
      width: 100%;
      margin: 0 auto;
      box-sizing: border-box;
    }

    /* image + name row */
    .po-hero {
      display: flex;
      align-items: center;
      gap: 2rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      margin-bottom: 2.5rem;
    }
    .po-headshot-wrap {
      width: 120px;
      height: 140px;
      flex-shrink: 0;
      overflow: hidden;
      border-radius: 8px;
      background: linear-gradient(160deg, rgba(0,40,120,0.35), rgba(0,10,40,0.4));
      border: 1px solid rgba(255,255,255,0.08);
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }
    .po-headshot {
      width: 100%;
      object-fit: contain;
      object-position: bottom center;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
    }
    .po-identity { flex: 1; min-width: 0; }
    .po-bio {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem 1.2rem;
      margin-top: 0.75rem;
      padding-top: 0.7rem;
      border-top: 1px solid rgba(255,255,255,0.07);
    }
    .po-bio-item {
      display: flex;
      align-items: baseline;
      gap: 0.3rem;
      font-size: 0.8rem;
      font-weight: 500;
      color: rgba(255,255,255,0.62);
      white-space: nowrap;
    }
    .po-bio-label {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.25);
    }
    .po-summary {
      display: flex;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 2.5rem;
    }
    .po-summary-stat {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem 0.5rem 0.85rem;
      border-right: 1px solid rgba(255,255,255,0.07);
      background: rgba(255,255,255,0.025);
    }
    .po-summary-stat:last-child { border-right: none; }
    .po-summary-season {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.2);
      margin-bottom: 0.25rem;
    }
    .po-summary-val {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2.6rem;
      color: #fff;
      line-height: 1;
    }
    .po-summary-lbl {
      font-size: 0.58rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.38);
      margin-top: 0.2rem;
    }
    .po-jersey-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1rem;
      letter-spacing: 0.25em;
      color: rgba(255,255,255,0.22);
      margin-bottom: 0.1rem;
    }
    .po-name {
      font-family: 'Bebas Neue', sans-serif;
      font-size: clamp(2.2rem, 5vw, 3.6rem);
      letter-spacing: 0.02em;
      color: #fff;
      line-height: 1;
      margin-bottom: 0.45rem;
    }
    .po-pos {
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.32);
    }
    .po-stats { }

    @media (max-width: 600px) {
      .po-scroll { padding: 1.75rem 1.25rem 3rem; }
      .po-headshot-wrap { width: 90px; height: 108px; }
      .po-hero { gap: 1.25rem; margin-bottom: 1.75rem; padding-bottom: 1.5rem; }
      .po-name { font-size: 1.9rem; }
    }

    /* ── Tablet ─────────────────────────── */
    @media (max-width: 680px) {
      .stats-header span:last-child { display: none; }
      .team-stats { flex-wrap: wrap; }
      .stat-item  { min-width: 25%; flex: unset; border-right: none; padding: 0 0.25rem; }
      .performer  { min-width: 45%; }
    }

    /* ── Large phone ─────────────────────── */
    @media (max-width: 560px) {
      .bar-label { display: none; }
      .bar-link  { display: none; }
      .opening-day-bar { gap: 1rem; padding: 0.75rem 1rem; }
      .bar-logo  { height: 38px; }
      .bar-val   { font-size: 1.75rem; }
      .bar-sep   { font-size: 1.5rem; }
      .bar-lbl   { font-size: 0.5rem; }
      .bar-dot   { width: 7px; height: 7px; }

      .stats-panel { padding: 1rem 1rem 1.25rem; }
      .stat-item  { min-width: 33%; }
      .stat-val   { font-size: 1.35rem; }
      .stats-header { flex-wrap: wrap; gap: 0.3rem 0.5rem; }

    }

    /* ── Small phone (SE etc) ─────────────── */
    @media (max-width: 390px) {
      /* Keep safe area in padding — only shrink the base padding */
      .opening-day-bar {
        padding: calc(0.4rem + env(safe-area-inset-top, 0px)) 0.75rem 0.4rem;
        gap: 0.5rem;
      }
      .bar-logo      { height: 30px; }
      .bar-team-name { font-size: 1.2rem; }
      .p-name        { white-space: normal; }
    }

    /* ── Sidebar Nav Tabs ─────────────────────────────── */
    .sb-nav {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 0.5rem;
      flex-shrink: 0;
    }
    .sb-tab {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.52rem 0.75rem;
      border-radius: 8px;
      background: none;
      border: none;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 600;
      color: rgba(255,255,255,0.42);
      letter-spacing: 0.02em;
      text-align: left;
      width: 100%;
      transition: background 0.15s, color 0.15s;
      position: relative;
    }
    .sb-tab:hover {
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.75);
    }
    .sb-tab.active {
      background: rgba(255,255,255,0.10);
      color: #fff;
    }
    .sb-tab-icon {
      font-size: 0.95rem;
      width: 18px;
      text-align: center;
      flex-shrink: 0;
    }
    .sb-live-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #ff4444;
      margin-left: auto;
      flex-shrink: 0;
      animation: livepulse 1.4s ease-in-out infinite;
    }

    /* ── Depth Chart ──────────────────────────────────── */
    .dc-wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 2rem 2rem 4rem;
    }
    .dc-page-header {
      margin-bottom: 1.75rem;
    }
    .dc-page-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 2.2rem;
      letter-spacing: 0.08em;
      color: #fff;
      line-height: 1;
    }
    .dc-page-sub {
      font-size: 0.72rem;
      color: rgba(255,255,255,0.35);
      margin-top: 0.25rem;
      font-family: 'Inter', sans-serif;
    }
    .dc-section-label {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.85rem;
      letter-spacing: 0.18em;
      color: rgba(255,255,255,0.3);
      margin-bottom: 0.6rem;
      margin-top: 1.75rem;
    }
    .dc-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 0.75rem;
    }
    .dc-card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.07);
      border-radius: 10px;
      overflow: hidden;
    }
    .dc-pos-header {
      background: rgba(0,30,98,0.6);
      border-bottom: 1px solid rgba(255,255,255,0.07);
      padding: 0.45rem 0.75rem;
      display: flex;
      align-items: baseline;
      gap: 0.5rem;
    }
    .dc-pos-abbr {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.1rem;
      letter-spacing: 0.06em;
      color: #fff;
    }
    .dc-pos-name {
      font-size: 0.62rem;
      color: rgba(255,255,255,0.35);
      font-family: 'Inter', sans-serif;
    }
    .dc-players {
      display: flex;
      flex-direction: column;
    }
    .dc-player {
      display: flex;
      align-items: center;
      gap: 0.55rem;
      padding: 0.5rem 0.75rem;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      position: relative;
    }
    .dc-player:last-child { border-bottom: none; }
    .dc-player[onclick]:hover {
      background: rgba(255,255,255,0.06);
    }
    .dc-player.dc-starter {
      background: rgba(255,255,255,0.03);
    }
    .dc-player.dc-starter[onclick]:hover {
      background: rgba(255,255,255,0.08);
    }
    .dc-photo-wrap {
      flex-shrink: 0;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      overflow: hidden;
      background: rgba(255,255,255,0.06);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .dc-photo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: top center;
    }
    .dc-photo-fallback {
      font-size: 1rem;
      color: rgba(255,255,255,0.2);
    }
    .dc-player-info {
      flex: 1;
      min-width: 0;
    }
    .dc-player-name {
      font-size: 0.75rem;
      font-weight: 600;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .dc-player.dc-starter .dc-player-name {
      color: #fff;
    }
    .dc-player:not(.dc-starter) .dc-player-name {
      color: rgba(255,255,255,0.55);
      font-weight: 400;
    }
    .dc-depth-num {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.75rem;
      color: rgba(255,255,255,0.18);
      flex-shrink: 0;
    }
    .dc-starter .dc-depth-num {
      color: rgba(255,255,255,0.35);
    }
    .dc-loading {
      color: rgba(255,255,255,0.25);
      font-size: 0.8rem;
      padding: 3rem 0;
      text-align: center;
    }
    /* ── Nav Menu (≡ dropdown) ────────────────────────── */
    .nav-backdrop {
      position: fixed;
      inset: 0;
      z-index: 499;
      display: none;
    }
    .nav-backdrop.open { display: block; }
    .nav-menu {
      position: fixed;
      top: 72px;
      right: 0;
      width: 200px;
      background: rgba(0,12,50,0.97);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border-left: 1px solid rgba(255,255,255,0.08);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      border-bottom-left-radius: 10px;
      z-index: 500;
      display: flex;
      flex-direction: column;
      padding: 0.35rem;
      gap: 0;
      transform: translateY(-6px);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.15s ease, opacity 0.15s ease;
    }
    .nav-menu.open {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.6rem 0.75rem;
      border-radius: 4px;
      background: none;
      border: none;
      cursor: pointer;
      width: 100%;
      text-align: left;
      font-family: 'Inter', sans-serif;
      font-size: 0.85rem;
      font-weight: 500;
      color: rgba(255,255,255,0.6);
      letter-spacing: 0.01em;
      transition: background 0.12s, color 0.12s;
    }
    .nav-item:hover {
      background: rgba(255,255,255,0.05);
      color: #fff;
    }
    .nav-live-badge {
      margin-left: auto;
      font-size: 0.55rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      color: #ff4444;
      background: rgba(255,68,68,0.12);
      border: 1px solid rgba(255,68,68,0.35);
      border-radius: 3px;
      padding: 1px 4px;
      animation: livepulse 1.4s ease-in-out infinite;
      flex-shrink: 0;
    }
    .nav-divider {
      height: 1px;
      background: rgba(255,255,255,0.07);
      margin: 0.2rem 0;
    }

    /* ── View sections ────────────────────────────────── */
    .view-section { display: none; }
    .view-section.active { display: block; }

    /* ── Full Live Game View ──────────────────────────── */
    .live-full {
      min-height: calc(100dvh - 90px);
      padding: 2rem 2.5rem 4rem;
      display: flex;
      flex-direction: column;
      gap: 1.75rem;
      position: relative;
      z-index: 1;
    }
    .lf-header {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .lf-title {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.6rem;
      letter-spacing: 0.1em;
      color: #fff;
    }
    .lf-status {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.6rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,80,80,0.9);
    }

    /* Scoreboard */
    .lf-scoreboard {
      background: rgba(255,255,255,0.035);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      overflow: hidden;
    }
    .lf-sb-table {
      width: 100%;
      border-collapse: collapse;
      font-family: 'Bebas Neue', sans-serif;
    }
    .lf-sb-table th {
      font-size: 0.62rem;
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      padding: 0.6rem 0.5rem;
      text-align: center;
      border-bottom: 1px solid rgba(255,255,255,0.07);
    }
    .lf-sb-table th:first-child { text-align: left; padding-left: 1rem; min-width: 90px; }
    .lf-sb-table td {
      text-align: center;
      padding: 0.55rem 0.5rem;
      font-size: 0.95rem;
      color: rgba(255,255,255,0.7);
      border-right: 1px solid rgba(255,255,255,0.05);
    }
    .lf-sb-table td:last-child { border-right: none; }
    .lf-sb-table td:first-child {
      text-align: left;
      padding-left: 1rem;
      font-family: 'Inter', sans-serif;
      font-size: 0.8rem;
      font-weight: 700;
      color: rgba(255,255,255,0.85);
    }
    .lf-sb-table tr:last-child td { border-bottom: none; }
    .lf-sb-table tbody tr:not(:last-child) td { border-bottom: 1px solid rgba(255,255,255,0.04); }
    .lf-sb-table td.lf-cur-inn {
      color: #fff;
      background: rgba(255,255,255,0.08);
      font-weight: 700;
    }
    .lf-sb-table .lf-totals td {
      border-top: 2px solid rgba(255,255,255,0.1);
      color: #fff;
      font-size: 1.05rem;
    }
    .lf-sb-team {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .lf-sb-logo { height: 22px; width: auto; }

    /* Body layout: at-bat + play log side by side */
    .lf-body {
      display: grid;
      grid-template-columns: 340px 1fr;
      gap: 1.5rem;
      align-items: start;
    }
    @media (max-width: 900px) {
      .lf-body { grid-template-columns: 1fr; }
      .live-full { padding: 1.25rem 1.25rem 3rem; }
    }

    /* At-bat panel */
    .lf-at-bat {
      background: rgba(255,255,255,0.035);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      padding: 1.1rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.85rem;
    }
    .lf-at-bat-header {
      font-size: 0.58rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      padding-bottom: 0.6rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
    }
    .lf-matchup {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }
    .lf-matchup-row {
      display: flex;
      align-items: center;
      gap: 0.45rem;
    }
    .lf-role {
      font-size: 0.44rem;
      font-weight: 700;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      background: rgba(255,255,255,0.07);
      border-radius: 3px;
      padding: 0.12rem 0.3rem;
      flex-shrink: 0;
    }
    .lf-player-name {
      font-size: 0.88rem;
      font-weight: 600;
      color: rgba(255,255,255,0.9);
    }

    /* Zone + count row */
    .lf-zone-count {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
    }
    .lf-zone-wrap {
      flex-shrink: 0;
    }
    .lf-zone-svg { display: block; }

    /* Count dots in at-bat panel */
    .lf-count-col {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      padding-top: 4px;
    }
    .lf-count-row {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    .lf-count-lbl {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      color: rgba(255,255,255,0.3);
      width: 12px;
    }
    .lf-count-dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      border: 1.5px solid rgba(255,255,255,0.2);
      background: transparent;
    }
    .lf-count-dot.ball   { background: rgba(100,200,100,0.85); border-color: rgba(100,200,100,1); }
    .lf-count-dot.strike { background: rgba(230,170,40,0.85);  border-color: rgba(230,170,40,1); }
    .lf-count-dot.out    { background: rgba(220,60,40,0.85);   border-color: rgba(220,60,40,1); }

    /* Pitch log */
    .lf-pitch-log {
      display: flex;
      flex-direction: column;
      gap: 0;
    }
    .lf-pitch-log-label {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.25);
      margin-bottom: 0.4rem;
    }
    .lf-pitch-row {
      display: grid;
      grid-template-columns: 20px 48px 1fr auto;
      align-items: center;
      gap: 0.4rem;
      padding: 0.3rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      font-size: 0.72rem;
    }
    .lf-pitch-row:last-child { border-bottom: none; }
    .lf-pitch-num { color: rgba(255,255,255,0.25); font-size: 0.62rem; }
    .lf-pitch-speed { font-family: 'Bebas Neue', sans-serif; font-size: 0.9rem; color: #fff; }
    .lf-pitch-type { color: rgba(255,255,255,0.55); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .lf-pitch-result { font-size: 0.6rem; font-weight: 700; letter-spacing: 0.08em; padding: 0.1rem 0.35rem; border-radius: 3px; }
    .lf-pitch-result.ball   { color: rgba(100,200,100,0.9); background: rgba(100,200,100,0.12); }
    .lf-pitch-result.strike { color: rgba(230,170,40,0.9);  background: rgba(230,170,40,0.12); }
    .lf-pitch-result.foul   { color: rgba(255,200,80,0.9);  background: rgba(255,200,80,0.10); }
    .lf-pitch-result.inplay { color: rgba(100,160,255,0.9); background: rgba(100,160,255,0.12); }

    /* Play-by-play log */
    .lf-play-log {
      background: rgba(255,255,255,0.035);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .lf-play-log-header {
      font-size: 0.58rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
      padding: 0.75rem 1rem 0.6rem;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      flex-shrink: 0;
    }
    .lf-play-log-scroll {
      max-height: 420px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,0.1) transparent;
    }
    .lf-play-log-scroll::-webkit-scrollbar { width: 4px; }
    .lf-play-log-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius: 2px; }
    .lf-pp-row {
      display: grid;
      grid-template-columns: 40px 1fr;
      gap: 0.75rem;
      padding: 0.65rem 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.04);
      align-items: flex-start;
    }
    .lf-pp-row:last-child { border-bottom: none; }
    .lf-pp-inn {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.85rem;
      letter-spacing: 0.04em;
      color: rgba(255,255,255,0.4);
      text-align: center;
      line-height: 1.2;
      padding-top: 1px;
    }
    .lf-pp-event {
      font-size: 0.78rem;
      font-weight: 700;
      color: rgba(255,255,255,0.85);
      margin-bottom: 0.2rem;
    }
    .lf-pp-desc {
      font-size: 0.68rem;
      color: rgba(255,255,255,0.42);
      line-height: 1.5;
    }
    .lf-empty {
      padding: 3rem 1.5rem;
      text-align: center;
      font-size: 0.65rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.15);
    }

    /* ── Sidebar Nav ─────────────────────────────────────── */
    .sb-nav {
      background: rgba(5,7,20,0.55);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      margin-bottom: 0.5rem;
      flex-shrink: 0;
    }
    .sb-nav-item {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      padding: 0.6rem 0.85rem;
      border: none;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      background: none;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 500;
      color: rgba(255,255,255,0.45);
      text-align: left;
      width: 100%;
      transition: background 0.15s, color 0.15s;
      -webkit-tap-highlight-color: transparent;
    }
    .sb-nav-item:last-child { border-bottom: none; }
    .sb-nav-item:hover {
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.8);
    }
    .sb-nav-item.active {
      background: rgba(255,255,255,0.10);
      color: #fff;
      font-weight: 600;
    }
    .sb-nav-lbl { flex: 1; }
    .sb-nav-badge {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      color: #ff4444;
      background: rgba(255,68,68,0.12);
      border: 1px solid rgba(255,68,68,0.35);
      border-radius: 3px;
      padding: 1px 4px;
      animation: livepulse 1.4s ease-in-out infinite;
      flex-shrink: 0;
    }

    /* ── Mobile 3-tab bar updates ──────────────────────────── */
    @media (max-width: 700px) {
      .mob-tabs {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
      }
      /* Center logo tab */
      .mob-tab-center {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: var(--team-header2, #003DA5);
        border: 3px solid rgba(255,255,255,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 12px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.5);
        flex-shrink: 0;
        position: relative;
        z-index: 10;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        transition: background 0.15s;
        padding: 0;
      }
      .mob-tab-center:active { opacity: 0.6; }
      .mob-tab-center img {
        width: 38px;
        height: 38px;
        object-fit: contain;
      }
      .mob-tab-center.active {
        background: rgba(255,255,255,0.12);
        border-color: rgba(255,255,255,0.28);
      }

      /* More sheet backdrop */
      .mob-more-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        z-index: 355;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.25s ease;
      }
      .mob-more-backdrop.open {
        opacity: 1;
        pointer-events: all;
      }

      /* More slide-up sheet */
      .mob-more-sheet {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        min-height: 52vh;
        background: rgba(0,7,32,0.98);
        backdrop-filter: blur(28px);
        -webkit-backdrop-filter: blur(28px);
        border-top: 1px solid rgba(255,255,255,0.1);
        border-radius: 22px 22px 0 0;
        z-index: 360;
        padding: 0 1.25rem calc(2rem + env(safe-area-inset-bottom, 0px));
        transform: translateY(100%);
        transition: transform 0.32s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .mob-more-sheet.open {
        transform: translateY(0);
      }
      .mob-more-handle {
        width: 40px;
        height: 5px;
        background: rgba(255,255,255,0.25);
        border-radius: 3px;
        margin: 12px auto 20px;
      }

      /* More grid */
      .mob-more-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
      }
      .mob-more-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.6rem;
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 16px;
        padding: 1.4rem 0.5rem 1.2rem;
        cursor: pointer;
        color: rgba(255,255,255,0.75);
        font-family: 'Inter', sans-serif;
        font-size: 0.78rem;
        font-weight: 500;
        -webkit-tap-highlight-color: transparent;
        transition: background 0.15s, color 0.15s;
      }
      .mob-more-item:active {
        background: rgba(255,255,255,0.12);
        color: #fff;
      }

      /* Hide sidebar nav on mobile */
      .sb-nav { display: none; }
    }

    /* ── Contracts & Payroll ─────────────────────────────── */
    .contracts-wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 2rem 2rem 4rem;
    }
    @media (max-width: 700px) {
      .contracts-wrap { padding: 1rem 0.75rem 3rem; }
    }
    .payroll-bar-wrap {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 1rem 1.1rem 1.1rem;
      margin-bottom: 1.5rem;
      position: relative;
    }
    .payroll-bar-label {
      font-size: 0.56rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      margin-bottom: 0.6rem;
    }
    .payroll-bar-track {
      background: rgba(255,255,255,0.07);
      border-radius: 4px;
      height: 14px;
      position: relative;
      overflow: visible;
    }
    .payroll-bar {
      height: 100%;
      border-radius: 4px;
      background: linear-gradient(90deg, #003DA5 0%, #0052cc 100%);
      position: relative;
      transition: width 0.6s ease;
    }
    .payroll-marker {
      position: absolute;
      top: -6px;
      bottom: -6px;
      width: 2px;
      background: rgba(230,170,40,0.9);
      border-radius: 1px;
    }
    .payroll-marker-label {
      position: absolute;
      top: -18px;
      left: 4px;
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      color: rgba(230,170,40,0.9);
      white-space: nowrap;
    }
    .payroll-totals {
      display: flex;
      justify-content: space-between;
      margin-top: 0.6rem;
    }
    .payroll-total-item {
      display: flex;
      flex-direction: column;
    }
    .payroll-total-val {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.4rem;
      color: #fff;
      line-height: 1;
    }
    .payroll-total-lbl {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.28);
    }

    /* Salary chart */
    .salary-chart {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 1rem 1.1rem;
      margin-bottom: 1.5rem;
    }
    .salary-chart-title {
      font-size: 0.56rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      margin-bottom: 0.85rem;
    }
    .salary-row {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.3rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .salary-row:last-child { border-bottom: none; }
    .salary-name {
      font-size: 0.75rem;
      font-weight: 600;
      color: rgba(255,255,255,0.8);
      width: 110px;
      flex-shrink: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .salary-bar-wrap {
      flex: 1;
      background: rgba(255,255,255,0.06);
      border-radius: 3px;
      height: 8px;
      overflow: hidden;
    }
    .salary-bar {
      height: 100%;
      border-radius: 3px;
      background: linear-gradient(90deg, #003DA5 0%, #0052cc 100%);
    }
    .salary-val {
      font-family: 'Bebas Neue', sans-serif;
      font-size: 0.9rem;
      color: rgba(255,255,255,0.6);
      min-width: 48px;
      text-align: right;
      flex-shrink: 0;
    }
    .salary-pos {
      font-size: 0.52rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      color: rgba(255,255,255,0.3);
      width: 24px;
      flex-shrink: 0;
    }

    /* Contract timeline (Gantt) */
    .contract-timeline {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 1rem 1.1rem;
      overflow-x: auto;
    }
    .contract-timeline-title {
      font-size: 0.56rem;
      font-weight: 700;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.3);
      margin-bottom: 0.75rem;
    }
    .ct-year-labels {
      display: flex;
      margin-left: 110px;
      margin-bottom: 0.3rem;
    }
    .ct-year-label {
      font-size: 0.52rem;
      font-weight: 700;
      color: rgba(255,255,255,0.22);
      flex: 1;
      text-align: center;
    }
    .ct-row {
      display: flex;
      align-items: center;
      gap: 0;
      padding: 0.22rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .ct-row:last-child { border-bottom: none; }
    .ct-name {
      font-size: 0.72rem;
      font-weight: 600;
      color: rgba(255,255,255,0.7);
      width: 110px;
      flex-shrink: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 0.5rem;
    }
    .ct-bar-wrap {
      flex: 1;
      position: relative;
      height: 14px;
    }
    .ct-bar {
      position: absolute;
      height: 100%;
      border-radius: 3px;
      background: linear-gradient(90deg, rgba(0,61,165,0.75), rgba(0,82,204,0.65));
      border: 1px solid rgba(0,82,204,0.5);
      display: flex;
      align-items: center;
      padding: 0 4px;
      min-width: 4px;
    }
    .ct-bar-aav {
      font-size: 0.48rem;
      font-weight: 700;
      color: rgba(255,255,255,0.7);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

  </style>
</head>
<body data-team="dodgers">

  <!-- Team header bar -->
  <div class="opening-day-bar" style="position:relative;">
    <img class="bar-logo" id="bar-logo"
      src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg"
      alt="Dodgers"
      onclick="switchView('home')"
      style="cursor:pointer" />
    <div class="bar-team-info">
      <span class="bar-team-name" id="bar-team-name">Los Angeles Dodgers</span>
      <span class="bar-team-sub" id="bar-team-sub">NL West</span>
    </div>
    <div class="bar-actions">
      <button class="settings-icon-btn" id="settings-icon-btn" onclick="toggleSettingsDropdown()" aria-label="Settings">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
      <!-- Settings dropdown -->
      <div class="settings-dropdown" id="settings-dropdown">
        <div class="sdrop-section-label">Teams</div>
        <button class="sdrop-team-row active" id="sdrop-dodgers" onclick="settingsPickTeam('dodgers')">
          <img src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg" alt="LAD">
          <span>Los Angeles Dodgers</span>
          <span class="sdrop-check" id="sdrop-check-dodgers">✓</span>
        </button>
        <button class="sdrop-team-row" id="sdrop-mets" onclick="settingsPickTeam('mets')">
          <img src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/121.svg" alt="NYM">
          <span>New York Mets</span>
          <span class="sdrop-check" id="sdrop-check-mets" style="display:none">✓</span>
        </button>
        <div class="sdrop-divider"></div>
        <button class="sdrop-save-btn" onclick="saveDefaultTeam()">
          <svg viewBox="0 0 24 24" fill="currentColor" width="13" height="13"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          Save as Default Team
        </button>
        <div class="sdrop-saved-msg" id="sdrop-saved-msg" style="display:none">✓ Saved as default</div>
      </div>
    </div>
  </div>

  <!-- Fixed left sidebar -->
  <div class="fixed-sidebar" id="fixed-sidebar">
    <!-- Stats only — nav is in right-nav -->
    <div class="dash-label">
      <span class="stats-season">2025 Season</span>
      <span class="stats-divider">·</span>
      <span class="stats-division">NL West</span>
    </div>
    <div class="dash-card">
      <div class="dash-card-header">
        <span class="dash-card-label">Team Stats</span>
      </div>
      <div class="team-stats">
        <div class="stat-item"><span class="stat-val">100-62</span><span class="stat-lbl">Record</span><span class="stat-rank">#2 NL West</span></div>
        <div class="stat-item"><span class="stat-val">.617</span><span class="stat-lbl">Win %</span><span class="stat-rank">#2 NL West</span></div>
        <div class="stat-item"><span class="stat-val">.263</span><span class="stat-lbl">Team AVG</span><span class="stat-rank">#3 NL</span></div>
        <div class="stat-item"><span class="stat-val">221</span><span class="stat-lbl">Home Runs</span><span class="stat-rank">#2 NL</span></div>
        <div class="stat-item"><span class="stat-val">1,418</span><span class="stat-lbl">Hits</span></div>
        <div class="stat-item"><span class="stat-val">3.61</span><span class="stat-lbl">Team ERA</span><span class="stat-rank">#4 NL</span></div>
        <div class="stat-item"><span class="stat-val">1,344</span><span class="stat-lbl">Strikeouts</span></div>
      </div>
    </div>
    <div class="dash-card">
      <div class="dash-card-header">
        <span class="dash-card-label">Last Game</span>
        <span class="performers-date dash-card-sub">Sep 28, 2025</span>
      </div>
      <div class="lg-score" id="lg-score">
        <div class="lgs-side"><span class="lgs-abbr">LAD</span><span class="lgs-num">8</span></div>
        <span class="lgs-sep">—</span>
        <div class="lgs-side"><span class="lgs-num">3</span><span class="lgs-abbr">SD</span></div>
      </div>
      <div class="performers-label">Top Performers</div>
      <div class="performers">
        <div class="performer">
          <span class="p-name">Shohei Ohtani</span>
          <span class="p-line">3-4 · HR · 3 RBI</span>
        </div>
        <div class="performer">
          <span class="p-name">Freddie Freeman</span>
          <span class="p-line">2-3 · 2B · 2 RBI</span>
        </div>
        <div class="performer">
          <span class="p-name">Mookie Betts</span>
          <span class="p-line">2-4 · HR · BB</span>
        </div>
        <div class="performer">
          <span class="p-name">Y. Yamamoto</span>
          <span class="p-line">7.0 IP · 1 ER · 10 K · W</span>
        </div>
      </div>
    </div>
    <!-- Live game card (shown automatically when game is in progress) -->
    <div class="dash-card" id="live-game-card" style="display:none"></div>
  </div>

  <!-- Main scrollable content -->
  <div class="main-content">

  <!-- Home view -->
  <div class="view-section active" id="view-home">
  <!-- Hero countdown section -->
  <section class="hero-section">
    <img class="hero-logo" id="hero-logo"
      src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg"
      alt="Dodgers" />
    <div class="hero-wordmark">
      <span class="hero-city" id="hero-city">Los Angeles</span>
      <span class="hero-team-name" id="hero-team-name-display">Dodgers</span>
    </div>
    <span class="hero-champs" id="hero-champs">Back-to-Back World Series Champions</span>
    <div class="ws-banners" id="ws-banners"></div>
  </section>
  </div><!-- /view-home -->

  <!-- Live game full view -->
  <div class="view-section" id="view-live">
    <div class="live-full" id="live-full-view">
      <div class="lf-empty">No live game data available.</div>
    </div>
  </div><!-- /view-live -->

  <!-- Depth Chart view -->
  <div class="view-section" id="view-depth">
    <div class="dc-wrap">
      <div class="dc-page-header">
        <div class="dc-page-title">Depth Chart</div>
        <div class="dc-page-sub" id="dc-page-sub">Los Angeles Dodgers · 2026</div>
      </div>
      <div class="dc-section-label">POSITION PLAYERS</div>
      <div class="dc-grid" id="dc-grid-pos"></div>
      <div class="dc-section-label">PITCHERS</div>
      <div class="dc-grid" id="dc-grid-pit"></div>
    </div>
  </div><!-- /view-depth -->

  <!-- Contracts & Payroll view -->
  <div class="view-section" id="view-contracts">
    <div class="contracts-wrap" id="contracts-wrap">
      <div class="dc-loading">Loading contracts…</div>
    </div>
  </div><!-- /view-contracts -->

  </div><!-- /main-content -->

  <!-- Right navigation panel (desktop only) -->
  <nav class="right-nav" id="right-nav">
    <div class="rn-label">Navigate</div>
    <button class="rn-item active" data-view="home" onclick="switchView('home')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 10.5L12 3l9 7.5V20a1 1 0 01-1 1H4a1 1 0 01-1-1z"/><path d="M9 21V13h6v8"/></svg>
      Home
    </button>
    <button class="rn-item" data-view="live" onclick="switchView('live')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="4" fill="currentColor" stroke="none"/><path d="M6.3 6.3a8 8 0 0 0 0 11.4" stroke-opacity=".5"/><path d="M17.7 17.7a8 8 0 0 0 0-11.4" stroke-opacity=".5"/></svg>
      Live Game
      <span class="rn-badge" id="sb-live-badge" style="display:none">LIVE</span>
    </button>
    <button class="rn-item" data-view="depth" onclick="switchView('depth')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="14" width="3.5" height="7" rx="1"/><rect x="10.25" y="9" width="3.5" height="12" rx="1"/><rect x="16.5" y="5" width="3.5" height="16" rx="1"/></svg>
      Depth Chart
    </button>
    <button class="rn-item" data-view="schedule" onclick="openSidePanel('schedule')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
      Schedule
    </button>
    <button class="rn-item" data-view="contracts" onclick="switchView('contracts')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/></svg>
      Contracts
    </button>
    <button class="rn-item" data-view="roster" onclick="openSidePanel('roster')">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="7" r="4"/><path d="M4 21c0-4.4 3.6-8 8-8s8 3.6 8 8"/></svg>
      Roster
    </button>
    <!-- Next game card pinned to bottom of right nav -->
    <div class="hero-next" id="hero-next" style="margin-top:auto; padding: 0 0.6rem 0.75rem;"></div>
  </nav>

  <!-- Side panel backdrop -->
  <div class="panel-backdrop" id="panel-backdrop" onclick="closePanel()"></div>

  <!-- Side panel -->
  <div class="side-panel" id="side-panel">
    <div class="sp-header" id="sp-header">
      <span class="sp-title" id="sp-title">Dodgers</span>
      <button class="filter-trigger-btn" id="filter-trigger-btn" onclick="toggleFilterSheet()" style="display:none">
        <svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor">
          <path d="M1 3h14v1.5l-5 5V15l-4-2V9.5L1 4.5V3z"/>
        </svg>
        Filter
        <span class="filter-badge" id="filter-badge" style="display:none">0</span>
      </button>
      <button class="sp-close" onclick="closePanel()">✕</button>
    </div>
    <div class="sp-tabs" id="sp-tabs">
      <button class="sp-tab active" onclick="switchSideTab('schedule')">Schedule</button>
      <button class="sp-tab" onclick="switchSideTab('roster')">40-Man Roster</button>
    </div>
    <div class="sp-body" id="sp-body">
      <div class="sp-panel active" id="sp-schedule">
        <!-- Filter sheet (hidden until tapped) -->
        <div class="sched-filter-sheet" id="sched-filter-sheet" style="display:none">
          <div class="sched-check-group-label">Location</div>
          <label class="sched-check-row">
            <input type="checkbox" id="filter-home" onchange="applyScheduleFilters()">
            <span class="sched-check-box"></span>
            <span class="sched-check-label">Home Games</span>
          </label>
          <label class="sched-check-row">
            <input type="checkbox" id="filter-away" onchange="applyScheduleFilters()">
            <span class="sched-check-box"></span>
            <span class="sched-check-label">Away Games</span>
          </label>
          <div class="sched-check-group-label sched-check-gap">Day of Week</div>
          <label class="sched-check-row">
            <input type="checkbox" id="filter-weekday" onchange="applyScheduleFilters()">
            <span class="sched-check-box"></span>
            <span class="sched-check-label">Weekdays</span>
          </label>
          <label class="sched-check-row">
            <input type="checkbox" id="filter-weekend" onchange="applyScheduleFilters()">
            <span class="sched-check-box"></span>
            <span class="sched-check-label">Weekends</span>
          </label>
          <div class="filter-sheet-actions">
            <button class="filter-clear-btn" onclick="clearScheduleFilters()">Clear All</button>
            <button class="filter-done-btn"  onclick="toggleFilterSheet()">Done</button>
          </div>
        </div>
        <!-- Game list -->
        <div class="schedule-list" id="schedule-list"></div>
        <!-- Game detail (shown when a game is tapped) -->
        <div class="game-detail" id="game-detail" style="display:none">
          <button class="gd-back" onclick="closeGameDetail()">‹ Schedule</button>
          <div class="gd-scroll" id="gd-scroll"></div>
        </div>
      </div>
      <div class="sp-panel" id="sp-roster">
        <div class="roster-placeholder">Roster Coming Soon</div>
      </div>
    </div>
  </div>

  <!-- Full-page player overlay -->
  <div class="player-overlay" id="player-overlay">
    <div class="po-topbar">
      <button class="po-back" onclick="closePlayerOverlay()">← Back to Roster</button>
      <span class="po-team-label" id="po-team-label">Los Angeles Dodgers</span>
    </div>
    <div class="po-scroll" id="po-scroll">
      <div class="po-hero">
        <div class="po-headshot-wrap">
          <img class="po-headshot" id="po-headshot" src="" alt="" />
        </div>
        <div class="po-identity">
          <div class="po-jersey-num" id="po-jersey-num"></div>
          <div class="po-name" id="po-name"></div>
          <div class="po-pos" id="po-pos"></div>
          <div class="po-bio" id="po-bio"></div>
        </div>
      </div>
      <div class="po-summary" id="po-summary" style="display:none"></div>
      <div class="po-stats" id="po-stats">
        <div class="pd-loading">Loading…</div>
      </div>
    </div>
    <div class="po-bottom-bar">
      <button class="po-bottom-back" onclick="closePlayerOverlay()" aria-label="Back to Roster">
        <img id="po-back-logo" src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg" alt="Back">
      </button>
    </div>
  </div>

  <script>
    /* ── Team data ──────────────────────────────────────── */
    let _currentTeamKey = 'dodgers'
    // Declared early so renderTeam() can reset all state safely on team switch
    let _liveGamePk       = null
    let _liveTimer        = null
    let _lastLiveData     = null
    let _depthLoaded      = false
    let _contractsLoaded  = false

    const TEAMS = {
      dodgers: {
        id: 119,
        name: 'Los Angeles Dodgers',
        cityShort: 'Los Angeles',
        nameShort: 'Dodgers',
        teamAbbr: 'LAD',
        espnId: 19,
        logoSrc: 'https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg',
        logoAlt: 'Dodgers',
        venueName: 'Dodger Stadium',
        openingDay: '2026-03-26T13:05:00',
        season: '2025 Season',
        division: 'NL West',
        wsTitles: [1955, 1959, 1963, 1965, 1981, 1988, 2020, 2024, 2025],
        wsLabel: 'Back-to-Back World Series Champions',
        bg1: '#002580', bg2: '#000D3A', bg3: '#000510',
        h1: '#001E62', h2: '#003DA5',
        stats: [
          { val: '100-62', lbl: 'Record',     rank: '#2 NL West' },
          { val: '.617',   lbl: 'Win %',      rank: '#2 NL West' },
          { val: '.263',   lbl: 'Team AVG',   rank: '#3 NL' },
          { val: '1,418',  lbl: 'Hits' },
          { val: '221',    lbl: 'Home Runs',  rank: '#2 NL' },
          { val: '3.61',   lbl: 'Team ERA',   rank: '#4 NL' },
          { val: '1,344',  lbl: 'Strikeouts' },
        ],
        lastGame: 'LAD 8, SD 3',
        lastGameDate: 'Sep 28, 2025',
        performers: [
          { role: 'Batter',  name: 'Shohei Ohtani',   line: '3-4 · HR · 3 RBI' },
          { role: 'Batter',  name: 'Freddie Freeman',  line: '2-3 · 2B · 2 RBI' },
          { role: 'Batter',  name: 'Mookie Betts',     line: '2-4 · HR · BB' },
          { role: 'Pitcher', name: 'Y. Yamamoto',      line: '7.0 IP · 1 ER · 10 K · W' },
        ],
        nextGame: {
          atVs: 'vs', opponent: 'Chicago Cubs', opponentShort: 'Cubs', logoId: 112,
          date: 'Thu, Mar 26', dateShort: 'Mar 26', time: '1:05 PM PT',
          tv: 'SportsNet LA', venue: 'Dodger Stadium', tag: 'Opening Day',
        },
        schedule: [
          { day: 'Thu', monthDay: 'Mar 26', atVs: 'vs', opponent: 'Chicago Cubs',     logoId: 112, venue: 'Home', time: '1:05 PM PT',  tv: 'SNLA' },
          { day: 'Fri', monthDay: 'Mar 27', atVs: 'vs', opponent: 'Chicago Cubs',     logoId: 112, venue: 'Home', time: '7:10 PM PT',  tv: 'SNLA' },
          { day: 'Sat', monthDay: 'Mar 28', atVs: 'vs', opponent: 'Chicago Cubs',     logoId: 112, venue: 'Home', time: '6:10 PM PT',  tv: 'FS1' },
          { day: 'Mon', monthDay: 'Mar 30', atVs: '@',  opponent: 'San Diego Padres', logoId: 135, venue: 'Away', time: '7:40 PM PT', tv: '' },
          { day: 'Tue', monthDay: 'Mar 31', atVs: '@',  opponent: 'San Diego Padres', logoId: 135, venue: 'Away', time: '7:40 PM PT', tv: '' },
          { day: 'Fri', monthDay: 'Apr 3',  atVs: 'vs', opponent: 'SF Giants',        logoId: 137, venue: 'Home', time: '7:10 PM PT',  tv: '' },
          { day: 'Sat', monthDay: 'Apr 4',  atVs: 'vs', opponent: 'SF Giants',        logoId: 137, venue: 'Home', time: '6:10 PM PT',  tv: 'FS1' },
        ],
      },
      mets: {
        id: 121,
        name: 'New York Mets',
        cityShort: 'New York',
        nameShort: 'Mets',
        teamAbbr: 'NYM',
        espnId: 21,
        logoSrc: 'https://www.mlbstatic.com/team-logos/team-cap-on-dark/121.svg',
        logoAlt: 'Mets',
        venueName: 'Citi Field',
        openingDay: '2026-03-26T13:10:00',
        season: '2025 Season',
        division: 'NL East',
        wsTitles: [1969, 1986],
        wsLabel: '2× World Series Champions',
        bg1: '#001840', bg2: '#000E30', bg3: '#000515',
        h1: '#001840', h2: '#002D72',
        stats: [
          { val: '89-73',  lbl: 'Record',     rank: '#3 NL East' },
          { val: '.549',   lbl: 'Win %',       rank: '#3 NL East' },
          { val: '.243',   lbl: 'Team AVG',    rank: '#8 NL' },
          { val: '1,280',  lbl: 'Hits' },
          { val: '197',    lbl: 'Home Runs',   rank: '#4 NL' },
          { val: '3.91',   lbl: 'Team ERA',    rank: '#6 NL' },
          { val: '1,289',  lbl: 'Strikeouts' },
        ],
        lastGame: 'NYM 4, PHI 2',
        lastGameDate: 'Sep 28, 2025',
        performers: [
          { role: 'Batter',  name: 'Juan Soto',        line: '2-4 · HR · 2 RBI' },
          { role: 'Batter',  name: 'Francisco Lindor',  line: '2-3 · 2B · RBI' },
          { role: 'Pitcher', name: 'Sean Manaea',        line: '6.0 IP · 1 ER · 8 K · W' },
        ],
        nextGame: {
          atVs: 'vs', opponent: 'Milwaukee Brewers', opponentShort: 'Brewers', logoId: 158,
          date: 'Thu, Mar 26', dateShort: 'Mar 26', time: '1:10 PM ET',
          tv: 'SNY', venue: 'Citi Field', tag: 'Opening Day',
        },
        schedule: [
          { day: 'Thu', monthDay: 'Mar 26', atVs: 'vs', opponent: 'Milwaukee Brewers', logoId: 158, venue: 'Home', time: '1:10 PM ET',  tv: 'SNY' },
          { day: 'Fri', monthDay: 'Mar 27', atVs: 'vs', opponent: 'Milwaukee Brewers', logoId: 158, venue: 'Home', time: '7:10 PM ET',  tv: 'SNY' },
          { day: 'Sat', monthDay: 'Mar 28', atVs: 'vs', opponent: 'Milwaukee Brewers', logoId: 158, venue: 'Home', time: '4:05 PM ET',  tv: 'FS1' },
          { day: 'Mon', monthDay: 'Mar 30', atVs: '@',  opponent: 'Philadelphia Phillies', logoId: 143, venue: 'Away', time: '3:05 PM ET', tv: 'SNY' },
          { day: 'Tue', monthDay: 'Mar 31', atVs: '@',  opponent: 'Philadelphia Phillies', logoId: 143, venue: 'Away', time: '6:40 PM ET', tv: '' },
          { day: 'Fri', monthDay: 'Apr 3',  atVs: 'vs', opponent: 'Atlanta Braves',     logoId: 144, venue: 'Home', time: '7:10 PM ET',  tv: 'SNY' },
          { day: 'Sat', monthDay: 'Apr 4',  atVs: 'vs', opponent: 'Atlanta Braves',     logoId: 144, venue: 'Home', time: '4:10 PM ET',  tv: 'FS1' },
        ],
      },
    }


    /* ── Team rendering ─────────────────────────────────── */
    function renderTeam(key) {
      const t = TEAMS[key]
      if (!t) return
      _currentTeamKey = key
      document.body.dataset.team = key
      localStorage.setItem('selectedTeam', key)

      // Apply team colors via CSS variables
      const r = document.documentElement.style
      r.setProperty('--team-bg1', t.bg1)
      r.setProperty('--team-bg2', t.bg2)
      r.setProperty('--team-bg3', t.bg3)
      r.setProperty('--team-header1', t.h1)
      r.setProperty('--team-header2', t.h2)

      // Bar logo + team name
      const logo = document.getElementById('bar-logo')
      logo.src = t.logoSrc
      logo.alt = t.logoAlt
      document.getElementById('bar-team-name').textContent = t.name
      document.getElementById('bar-team-sub').textContent  = t.division

      // Hero section
      const heroLogo = document.getElementById('hero-logo')
      if (heroLogo) { heroLogo.src = t.logoSrc; heroLogo.alt = t.logoAlt }
      const heroCity = document.getElementById('hero-city')
      if (heroCity) heroCity.textContent = t.cityShort
      const heroName = document.getElementById('hero-team-name-display')
      if (heroName) heroName.textContent = t.nameShort
      const heroChamps = document.getElementById('hero-champs')
      if (heroChamps) heroChamps.textContent = t.wsLabel ?? ''

      // WS banners — render from team config
      const wsEl = document.getElementById('ws-banners')
      if (wsEl) {
        wsEl.innerHTML = (t.wsTitles ?? []).map(yr =>
          `<div class="ws-banner" onclick="openWsModal(${yr})"><span class="ws-banner-year">${yr}</span></div>`
        ).join('')
      }

      // Dash label
      document.querySelector('.stats-season').textContent  = t.season
      document.querySelector('.stats-division').textContent = t.division

      // Team stats grid
      document.querySelector('.team-stats').innerHTML = t.stats.map(s => `
        <div class="stat-item">
          <span class="stat-val">${s.val}</span>
          <span class="stat-lbl">${s.lbl}</span>
          ${s.rank ? `<span class="stat-rank">${s.rank}</span>` : ''}
        </div>`).join('')

      // Last game date + score + performers
      document.querySelector('.performers-date').textContent = t.lastGameDate
      renderLgScore(t.lastGame)
      document.querySelector('.performers').innerHTML = (t.performers ?? []).map(p => `
        <div class="performer">
          <span class="p-name">${p.name}</span>
          <span class="p-line">${p.line}</span>
        </div>`).join('')

      // Schedule + next game
      renderSchedule(t.schedule)
      renderNextGame(t.nextGame)

      // Sync settings dropdown team selection
      document.querySelectorAll('.sdrop-team-row').forEach(el => el.classList.toggle('active', el.id === `sdrop-${key}`))
      document.querySelectorAll('.sdrop-check').forEach(el => el.style.display = 'none')
      const sdropCheck = document.getElementById(`sdrop-check-${key}`)
      if (sdropCheck) sdropCheck.style.display = ''

      // Reset lazy-load guards so depth chart + roster reload for new team
      _depthLoaded = false
      rosterLoaded = false
      _contractsLoaded = false

      // Update mobile center logo
      const centerLogo = document.getElementById('mob-center-logo')
      if (centerLogo) { centerLogo.src = t.logoSrc; centerLogo.alt = t.logoAlt }

      // Restart live tracker for new team
      if (_liveTimer) { clearInterval(_liveTimer); _liveTimer = null }
      _liveGamePk  = null
      _lastLiveData = null
      document.getElementById('live-game-card').style.display = 'none'

      // Reload all live/dynamic data
      loadLiveData()
      loadNews()
      startLiveTracker()
    }

    /* ── Next game renderer ─────────────────────────────── */
    function renderNextGame(g) {
      const el = document.getElementById('hero-next')
      if (!el || !g) return
      const myLogo  = TEAMS[_currentTeamKey]?.logoSrc ?? 'https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg'
      const oppLogo = `https://www.mlbstatic.com/team-logos/team-cap-on-dark/${g.logoId}.svg`
      const isHome  = g.atVs === 'vs' || g.isHome === true
      const atVs    = g.atVs || (isHome ? 'vs' : '@')
      const venue   = g.venueName || g.venue || ''
      const dateStr = g.monthDay || g.dateShort || g.date || ''
      const leftLogo  = isHome ? myLogo  : oppLogo
      const rightLogo = isHome ? oppLogo : myLogo
      el.innerHTML = `
        <div class="hero-next-label">Next Game</div>
        ${venue ? `<div class="hero-next-venue">${venue}</div>` : ''}
        <div class="hero-next-matchup">
          <img class="hero-next-logo" src="${leftLogo}" alt="">
          <span class="hero-next-sep">${atVs}</span>
          <img class="hero-next-logo" src="${rightLogo}" alt="${g.opponent}">
          <span class="hero-next-team">${g.opponent}</span>
        </div>
        <div class="hero-next-time">${dateStr ? dateStr + ' · ' : ''}${g.time}</div>`
    }

    /* ── Last game score display ─────────────────────────── */
    function renderLgScore(scoreStr) {
      const el = document.getElementById('lg-score')
      if (!el || !scoreStr) return
      // e.g. "LAD 8, SD 3"
      const parts = scoreStr.split(',').map(s => s.trim())
      if (parts.length !== 2) return
      const [a1, s1] = parts[0].split(' ')
      const [a2, s2] = parts[1].split(' ')
      el.innerHTML = `
        <div class="lgs-side"><span class="lgs-abbr">${a1}</span><span class="lgs-num">${s1}</span></div>
        <span class="lgs-sep">—</span>
        <div class="lgs-side"><span class="lgs-num">${s2}</span><span class="lgs-abbr">${a2}</span></div>`
    }

    /* ── News loader ─────────────────────────────────────── */
    async function loadNews() {
      const grid = document.getElementById('news-grid')
      if (!grid) return
      try {
        const espnId = TEAMS[_currentTeamKey]?.espnId ?? 19
        const res  = await fetch(`https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/news?team=${espnId}&limit=6`)
        const data = await res.json()
        const articles = data.articles ?? []
        if (!articles.length) { grid.innerHTML = '<div class="news-loading">No articles found</div>'; return }
        grid.innerHTML = articles.map(a => {
          const img     = a.images?.[0]?.url ?? ''
          const href    = a.links?.web?.href ?? '#'
          const ago     = timeAgo(a.published)
          const source  = a.categories?.find(c => c.type === 'league')?.description ?? 'ESPN'
          return `<a class="news-card" href="${href}" target="_blank" rel="noopener">
            ${img ? `<img class="news-card-img" src="${img}" alt="" loading="lazy">` : ''}
            <div class="news-card-body">
              <div class="news-card-headline">${a.headline}</div>
              <div class="news-card-meta">${ago}</div>
            </div>
          </a>`
        }).join('')
      } catch (e) {
        grid.innerHTML = '<div class="news-loading">Could not load news</div>'
      }
    }
    function timeAgo(iso) {
      if (!iso) return ''
      const mins = Math.floor((Date.now() - new Date(iso)) / 60000)
      if (mins < 60)  return `${mins}m ago`
      if (mins < 1440) return `${Math.floor(mins/60)}h ago`
      return `${Math.floor(mins/1440)}d ago`
    }

    /* ── Schedule renderer ──────────────────────────────── */
    let _allScheduleGames = []
    let _filteredGames    = []

    function renderSchedule(games) {
      _allScheduleGames = games
      applyScheduleFilters()
    }

    function toggleFilterSheet() {
      const sheet = document.getElementById('sched-filter-sheet')
      const isOpen = sheet.style.display !== 'none' && sheet.style.display !== ''
      sheet.style.display = isOpen ? 'none' : 'block'
      document.getElementById('filter-trigger-btn').classList.toggle('has-filters',
        !isOpen ? false : document.getElementById('filter-trigger-btn').classList.contains('has-filters'))
    }

    function applyScheduleFilters() {
      const homeChk    = document.getElementById('filter-home')?.checked    ?? false
      const awayChk    = document.getElementById('filter-away')?.checked    ?? false
      const weekdayChk = document.getElementById('filter-weekday')?.checked ?? false
      const weekendChk = document.getElementById('filter-weekend')?.checked ?? false

      _filteredGames = _allScheduleGames.filter(g => {
        const isWeekend  = ['Saturday','Sunday'].includes(g.weekday)
        const locationOk = (!homeChk && !awayChk) || (homeChk && g.isHome) || (awayChk && !g.isHome)
        const dayOk      = (!weekdayChk && !weekendChk) || (weekdayChk && !isWeekend) || (weekendChk && isWeekend)
        return locationOk && dayOk
      })

      const count = [homeChk, awayChk, weekdayChk, weekendChk].filter(Boolean).length
      const badge = document.getElementById('filter-badge')
      const btn   = document.getElementById('filter-trigger-btn')
      if (badge) { badge.textContent = count; badge.style.display = count > 0 ? 'inline' : 'none' }
      if (btn)   btn.classList.toggle('has-filters', count > 0)

      const list = document.getElementById('schedule-list')
      if (!list) return
      if (_filteredGames.length === 0) {
        list.innerHTML = '<div style="padding:2rem 1.25rem;font-size:0.72rem;color:rgba(255,255,255,0.25);text-align:center">No games match this filter</div>'
        return
      }
      list.innerHTML = _filteredGames.map((g, i) => `
        <div class="schedule-row" onclick="openGameDetail(${i})">
          <div class="sr-date">
            <span class="sr-day">${g.day}</span>
            <span class="sr-monthday">${g.monthDay}</span>
          </div>
          <div class="sr-opponent">
            <img class="sr-logo" src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/${g.logoId}.svg" alt="${g.opponent}">
            <div class="sr-opp-info">
              <span class="sr-at-vs">${g.atVs}</span>
              <span class="sr-name">${g.opponent}</span>
            </div>
          </div>
          <span class="sr-time">${g.time}</span>
          <span class="sr-chevron">›</span>
        </div>`).join('')
    }

    function clearScheduleFilters() {
      ['filter-home','filter-away','filter-weekday','filter-weekend'].forEach(id => {
        const el = document.getElementById(id)
        if (el) el.checked = false
      })
      applyScheduleFilters()
    }

    function openGameDetail(idx) {
      const g = _filteredGames[idx]
      if (!g) return
      // Swap list/filter for detail view
      document.getElementById('filter-trigger-btn').style.display = 'none'
      document.getElementById('sched-filter-sheet').style.display = 'none'
      document.getElementById('schedule-list').style.display    = 'none'
      document.getElementById('game-detail').style.display      = 'flex'

      const t = TEAMS[_currentTeamKey] ?? TEAMS.dodgers
      const myTeamId = t.id
      const homeName = g.isHome ? t.name : g.opponent
      const awayName = g.isHome ? g.opponent : t.name
      const homeLogoId = g.isHome ? myTeamId : g.logoId
      const awayLogoId = g.isHome ? g.logoId : myTeamId
      const LOGO_BASE = 'https://www.mlbstatic.com/team-logos/team-cap-on-dark'
      const gameUrl = `https://www.mlb.com/gameday/${g.gamePk}`
      const homeLabel = g.isHome ? `Home · ${t.venueName ?? 'Home Stadium'}` : 'Away'

      document.getElementById('gd-scroll').innerHTML = `
        <div class="gd-date-label">${g.fullDate}</div>
        <div class="gd-matchup">
          <div class="gd-team">
            <img class="gd-team-logo" src="${LOGO_BASE}/${awayLogoId}.svg" alt="${awayName}">
            <span class="gd-team-name">${awayName}</span>
          </div>
          <span class="gd-vs">@</span>
          <div class="gd-team">
            <img class="gd-team-logo" src="${LOGO_BASE}/${homeLogoId}.svg" alt="${homeName}">
            <span class="gd-team-name">${homeName}</span>
          </div>
        </div>
        <div class="gd-info-grid">
          <div class="gd-info-row">
            <span class="gd-info-label">First Pitch</span>
            <span class="gd-info-val">${g.time}</span>
          </div>
          <div class="gd-info-row">
            <span class="gd-info-label">Venue</span>
            <span class="gd-info-val">${g.venueName || '—'}</span>
          </div>
          ${g.tv ? `<div class="gd-info-row">
            <span class="gd-info-label">TV</span>
            <span class="gd-info-val">${g.tv}</span>
          </div>` : ''}
          <div class="gd-info-row">
            <span class="gd-info-label">Location</span>
            <span class="gd-info-val">${homeLabel}</span>
          </div>
        </div>
        <a class="gd-tickets-btn" href="${gameUrl}" target="_blank" rel="noopener">Get Tickets</a>`
    }

    function closeGameDetail() {
      document.getElementById('game-detail').style.display        = 'none'
      document.getElementById('filter-trigger-btn').style.display = ''
      document.getElementById('sched-filter-sheet').style.display = 'none'
      document.getElementById('schedule-list').style.display      = ''
    }

    /* ── Nav Menu (no-op, kept for safety) ─────────────────── */
    function toggleNavMenu() {}
    function openNavMenu() {}
    function closeNavMenu() {}
    document.addEventListener('keydown', e => { if (e.key === 'Escape') { closeMoreSheet(); closeWsModal() } })

    /* ── Side panel ─────────────────────────────────────── */
    function togglePanel() {
      document.getElementById('side-panel').classList.toggle('open')
      document.getElementById('panel-backdrop').classList.toggle('open')
    }
    function closePanel() {
      document.getElementById('side-panel').classList.remove('open')
      document.getElementById('panel-backdrop').classList.remove('open')
      document.getElementById('filter-trigger-btn').style.display = 'none'
      _setMobTab(_currentView)
    }
    function openSidePanel(tab) {
      if (tab === 'schedule') closeGameDetail()
      document.getElementById('side-panel').classList.add('open')
      document.getElementById('panel-backdrop').classList.add('open')
      switchSideTab(tab)
      // Update right-nav active state for schedule/roster
      document.querySelectorAll('.rn-item[data-view]').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.view === tab)
      })
      _setMobTab(tab)
      const titles = { schedule: 'Schedule', roster: '40-Man Roster' }
      const titleEl = document.getElementById('sp-title')
      if (titleEl && titles[tab]) titleEl.textContent = titles[tab]
      // Show filter button only on schedule tab
      document.getElementById('filter-trigger-btn').style.display = tab === 'schedule' ? '' : 'none'
    }
    let rosterLoaded = false
    function switchSideTab(id) {
      document.querySelectorAll('.sp-tab').forEach((btn, i) => {
        btn.classList.toggle('active', ['schedule','roster'][i] === id)
      })
      document.querySelectorAll('.sp-panel').forEach(p => {
        p.classList.toggle('active', p.id === `sp-${id}`)
      })
      if (id === 'roster' && !rosterLoaded) { rosterLoaded = true; loadRoster() }
    }

    /* ── 40-Man Roster ──────────────────────────────────── */
    async function loadRoster() {
      const el = document.getElementById('sp-roster')
      el.innerHTML = '<div class="roster-placeholder">Loading…</div>'
      try {
        const teamId = TEAMS[_currentTeamKey]?.id ?? 119
        const res = await fetch(`https://statsapi.mlb.com/api/v1/teams/${teamId}/roster?rosterType=40Man&season=2026`)
        const data = await res.json()
        renderRoster(data.roster ?? [])
      } catch (e) {
        el.innerHTML = '<div class="roster-placeholder">Could not load roster</div>'
      }
    }

    function renderRoster(roster) {
      const ORDER = ['Two-Way Player','Pitcher','Catcher','Infielder','Outfielder','Hitter']
      const LABELS = {
        'Two-Way Player': 'Two-Way Players',
        'Pitcher':        'Pitchers',
        'Catcher':        'Catchers',
        'Infielder':      'Infielders',
        'Outfielder':     'Outfielders',
        'Hitter':         'Designated Hitters',
      }
      const groups = {}
      ORDER.forEach(k => groups[k] = [])
      for (const p of roster) {
        const t = p.position?.type ?? 'Hitter'
        ;(groups[t] ?? groups['Hitter']).push(p)
      }
      document.getElementById('sp-roster').innerHTML = ORDER
        .filter(k => groups[k].length > 0)
        .map(k => `
          <div class="roster-group">
            <div class="roster-group-title">${LABELS[k]}</div>
            ${groups[k].map(p => `
              <div class="roster-row" onclick="openPlayerOverlay(${p.person.id},'${(p.position?.type||'').replace(/'/g,"\\'")}','${p.jerseyNumber||''}','${p.person.fullName.replace(/'/g,"\\'")}','${p.position.abbreviation}')">
                <span class="roster-num">${p.jerseyNumber || '–'}</span>
                <span class="roster-name">${p.person.fullName}</span>
                <span class="roster-pos">${p.position.abbreviation}</span>
                <span class="roster-chevron">›</span>
              </div>`).join('')}
          </div>`).join('')
    }

    /* ── Player overlay ─────────────────────────────────── */
    function openPlayerOverlay(id, posType, jersey, name, posAbbr) {
      const teamKey = document.body.dataset.team || 'dodgers'
      const t = TEAMS[teamKey] ?? TEAMS.dodgers
      document.getElementById('po-team-label').textContent = t.name
      document.getElementById('po-jersey-num').textContent = jersey ? `#${jersey}` : ''
      document.getElementById('po-name').textContent = name
      document.getElementById('po-pos').textContent = `${posAbbr} · ${t.name}`
      const backLogo = document.getElementById('po-back-logo')
      if (backLogo) backLogo.src = t.logoSrc
      const img = document.getElementById('po-headshot')
      img.src = `https://img.mlbstatic.com/mlb-photos/image/upload/d_people:generic:headshot:67:current.png/w_426,q_auto:best/v1/people/${id}/headshot/silo/current`
      img.alt = name
      document.getElementById('po-bio').innerHTML = ''
      document.getElementById('po-summary').style.display = 'none'
      document.getElementById('po-stats').innerHTML = '<div class="pd-loading">Loading…</div>'
      document.getElementById('po-scroll').scrollTop = 0
      document.getElementById('player-overlay').classList.add('open')
      document.body.style.overflow = 'hidden'
      fetchPlayerStatsOverlay(id, posType)
    }

    function closePlayerOverlay() {
      document.getElementById('player-overlay').classList.remove('open')
      document.body.style.overflow = ''
    }

    async function fetchPlayerStatsOverlay(playerId, posType) {
      try {
        const res = await fetch(
          `https://statsapi.mlb.com/api/v1/people/${playerId}?hydrate=stats(group=[hitting,pitching],type=[season,career],season=2025)`
        )
        const { people } = await res.json()
        const person = people[0] ?? {}
        const stats  = person.stats ?? []
        const get = (group, type) =>
          stats.find(s => s.group.displayName === group && s.type.displayName === type)?.splits?.[0]?.stat ?? null

        /* ── Bio strip ── */
        const bioEl = document.getElementById('po-bio')
        if (bioEl) {
          const items = [
            person.currentAge  && { lbl: 'Age',    val: person.currentAge },
            person.height      && { lbl: 'Height',  val: person.height },
            person.weight      && { lbl: 'Weight',  val: `${person.weight} lbs` },
            person.batSide?.description  && { lbl: 'Bats',   val: person.batSide.description },
            person.pitchHand?.description && { lbl: 'Throws', val: person.pitchHand.description },
            (person.birthCity || person.birthCountry) && {
              lbl: 'Born',
              val: [person.birthCity, person.birthCountry].filter(Boolean).join(', ')
            },
            person.mlbDebutDate && { lbl: 'Debut', val: new Date(person.mlbDebutDate).getFullYear() },
          ].filter(Boolean)
          bioEl.innerHTML = items.map(i =>
            `<div class="po-bio-item"><span class="po-bio-label">${i.lbl}</span><span>${i.val}</span></div>`
          ).join('')
        }

        const isPit = posType === 'Pitcher'
        const isTW  = posType === 'Two-Way Player'

        /* ── Summary card (2025 key stats) ── */
        const summaryEl = document.getElementById('po-summary')
        if (summaryEl) {
          const sh = !isPit ? get('hitting',  'season') : null
          const sp = (isPit || isTW) ? get('pitching', 'season') : null
          const summaryStats = sh
            ? [{ v: sh.avg, l: 'AVG' }, { v: sh.homeRuns, l: 'HR' }, { v: sh.rbi, l: 'RBI' }, { v: sh.ops, l: 'OPS' }]
            : sp
            ? [{ v: sp.era, l: 'ERA' }, { v: `${sp.wins??0}-${sp.losses??0}`, l: 'W-L' }, { v: sp.strikeOuts, l: 'K' }, { v: sp.whip, l: 'WHIP' }]
            : []
          if (summaryStats.length) {
            summaryEl.innerHTML = summaryStats.map(s => `
              <div class="po-summary-stat">
                <span class="po-summary-season">2025</span>
                <span class="po-summary-val">${s.v ?? '–'}</span>
                <span class="po-summary-lbl">${s.l}</span>
              </div>`).join('')
            summaryEl.style.display = ''
          }
        }

        /* ── Full stat sections ── */
        let html = ''
        if (!isPit) {
          const sh = get('hitting','season'), ch = get('hitting','career')
          if (sh) { const g = hitGrid(sh); html += statSection('2025 Season · Batting', g.primary, g.secondary) }
          if (ch)  { const g = hitGrid(ch); html += statSection('Career · Batting',     g.primary, g.secondary) }
        }
        if (isPit || isTW) {
          const sp = get('pitching','season'), cp = get('pitching','career')
          if (sp) { const g = pitGrid(sp); html += statSection('2025 Season · Pitching', g.primary, g.secondary) }
          if (cp)  { const g = pitGrid(cp); html += statSection('Career · Pitching',     g.primary, g.secondary) }
        }

        document.getElementById('po-stats').innerHTML =
          html || '<div class="pd-loading">No stats available</div>'
      } catch (e) {
        document.getElementById('po-stats').innerHTML =
          '<div class="pd-loading">Could not load stats</div>'
      }
    }

    function statSection(title, primaryHtml, secondaryHtml) {
      return `<div class="pd-section">
        <div class="pd-section-title">${title}</div>
        <div class="pd-stat-grid">${primaryHtml}</div>
        ${secondaryHtml ? `<div class="pd-stat-grid" style="border-top:1px solid rgba(255,255,255,0.05)">${secondaryHtml}</div>` : ''}
      </div>`
    }
    function pdStat(val, lbl) {
      return `<div class="pd-stat"><span class="pd-stat-val">${val ?? '–'}</span><span class="pd-stat-lbl">${lbl}</span></div>`
    }
    function hitGrid(s) {
      const primary = [
        pdStat(s.avg,       'AVG'),
        pdStat(s.homeRuns,  'HR'),
        pdStat(s.rbi,       'RBI'),
        pdStat(s.ops,       'OPS'),
      ].join('')
      const secondary = [
        pdStat(s.gamesPlayed,  'G'),
        pdStat(s.atBats,       'AB'),
        pdStat(s.hits,         'H'),
        pdStat(s.doubles,      '2B'),
        pdStat(s.stolenBases,  'SB'),
        pdStat(s.baseOnBalls,  'BB'),
        pdStat(s.strikeOuts,   'K'),
        pdStat(s.obp,          'OBP'),
      ].join('')
      return { primary, secondary }
    }
    function pitGrid(s) {
      const primary = [
        pdStat(s.era,                            'ERA'),
        pdStat(`${s.wins??0}-${s.losses??0}`,    'W-L'),
        pdStat(s.strikeOuts,                     'K'),
        pdStat(s.whip,                           'WHIP'),
      ].join('')
      const secondary = [
        pdStat(s.gamesPlayed,        'G'),
        pdStat(s.gamesStarted,       'GS'),
        pdStat(s.inningsPitched,     'IP'),
        pdStat(s.hits,               'H'),
        pdStat(s.baseOnBalls,        'BB'),
        pdStat(s.homeRuns,           'HR'),
        pdStat(s.strikeoutsPer9Inn,  'K/9'),
        pdStat(s.walksPer9Inn,       'BB/9'),
      ].join('')
      return { primary, secondary }
    }

    /* ── Settings dropdown ───────────────────────────────── */
    function toggleSettingsDropdown() {
      const dd  = document.getElementById('settings-dropdown')
      const btn = document.getElementById('settings-icon-btn')
      const isOpen = dd.classList.toggle('open')
      btn.classList.toggle('open', isOpen)
    }

    function settingsPickTeam(key) {
      switchTeam(key)
      // Leave dropdown open so user can hit "Save as Default"
    }

    function saveDefaultTeam() {
      localStorage.setItem('defaultTeam', _currentTeamKey)
      localStorage.setItem('selectedTeam', _currentTeamKey)
      const msg = document.getElementById('sdrop-saved-msg')
      if (!msg) return
      msg.style.display = 'block'
      setTimeout(() => { msg.style.display = 'none' }, 2200)
    }

    // Close settings dropdown when clicking outside
    document.addEventListener('click', e => {
      if (!e.target.closest('#settings-icon-btn') && !e.target.closest('#settings-dropdown')) {
        document.getElementById('settings-dropdown')?.classList.remove('open')
        document.getElementById('settings-icon-btn')?.classList.remove('open')
      }
    })

    /* ── Team switcher ───────────────────────────────────── */
    function switchTeam(key) {
      renderTeam(key)
    }

    // Restore saved team on load — prefer saved default, then last-used, then Dodgers
    const saved = localStorage.getItem('defaultTeam') || localStorage.getItem('selectedTeam')
    renderTeam(saved && TEAMS[saved] ? saved : 'dodgers')

    /* ── Live data from MLB Stats API ───────────────────────── */
    async function loadLiveData() {
      const key  = _currentTeamKey
      const t    = TEAMS[key]
      const TEAM = t.id
      const NL = new Set([109,144,112,113,115,119,146,121,143,134,135,137,138,120,158])

      function nlRank(splits, key, asc = false) {
        const nl = splits.filter(s => NL.has(s.team.id))
        const sorted = [...nl].sort((a, b) =>
          asc ? parseFloat(a.stat[key]) - parseFloat(b.stat[key])
              : parseFloat(b.stat[key]) - parseFloat(a.stat[key])
        )
        const i = sorted.findIndex(s => s.team.id === TEAM)
        return i >= 0 ? `#${i + 1} NL` : ''
      }

      /* ── 2025 season stats ── */
      try {
        const [standRes, batRes, pitRes] = await Promise.all([
          fetch('https://statsapi.mlb.com/api/v1/standings?leagueId=104&season=2025&standingsTypes=regularSeason'),
          fetch('https://statsapi.mlb.com/api/v1/teams/stats?stats=season&group=hitting&season=2025&sportId=1'),
          fetch('https://statsapi.mlb.com/api/v1/teams/stats?stats=season&group=pitching&season=2025&sportId=1'),
        ])
        const [stand, bat, pit] = await Promise.all([standRes.json(), batRes.json(), pitRes.json()])

        let rec = null
        for (const div of stand.records) {
          rec = div.teamRecords.find(r => r.team.id === TEAM)
          if (rec) break
        }

        const batSplits = bat.stats[0].splits
        const pitSplits = pit.stats[0].splits
        const db = batSplits.find(s => s.team.id === TEAM)?.stat
        const dp = pitSplits.find(s => s.team.id === TEAM)?.stat

        if (rec && db && dp) {
          const divRank = `#${rec.divisionRank} ${t.division}`
          const pct = parseFloat(rec.winningPercentage).toFixed(3).replace('0.', '.')
          TEAMS[key].stats = [
            { val: `${rec.wins}-${rec.losses}`,                  lbl: 'Record',     rank: divRank },
            { val: pct,                                           lbl: 'Win %',      rank: divRank },
            { val: db.avg,                                        lbl: 'Team AVG',   rank: nlRank(batSplits, 'avg') },
            { val: parseInt(db.hits).toLocaleString(),            lbl: 'Hits' },
            { val: db.homeRuns,                                   lbl: 'Home Runs',  rank: nlRank(batSplits, 'homeRuns') },
            { val: dp.era,                                        lbl: 'Team ERA',   rank: nlRank(pitSplits, 'era', true) },
            { val: parseInt(dp.strikeOuts).toLocaleString(),      lbl: 'Strikeouts' },
          ]
          // Only update DOM if team hasn't changed while fetching
          if (_currentTeamKey === key) {
            document.querySelector('.team-stats').innerHTML = TEAMS[key].stats.map(s => `
              <div class="stat-item">
                <span class="stat-val">${s.val}</span>
                <span class="stat-lbl">${s.lbl}</span>
                ${s.rank ? `<span class="stat-rank">${s.rank}</span>` : ''}
              </div>`).join('')
          }
        }
      } catch (e) { console.warn('Stats fetch failed', e) }

      /* ── 2026 schedule ── */
      try {
        const tz = TEAM === 121 ? 'America/New_York' : 'America/Los_Angeles'
        const tzSuffix = TEAM === 121 ? 'ET' : 'PT'
        const res = await fetch(`https://statsapi.mlb.com/api/v1/schedule?teamId=${TEAM}&season=2026&sportId=1&gameType=R`)
        const data = await res.json()
        if (data.dates?.length) {
          const games = []
          for (const d of data.dates) {
            for (const g of d.games) {
              const isHome = g.teams.home.team.id === TEAM
              const opp = isHome ? g.teams.away.team : g.teams.home.team
              const dt = new Date(g.gameDate)
              games.push({
                day:       dt.toLocaleDateString('en-US', { weekday: 'short', timeZone: tz }),
                monthDay:  dt.toLocaleDateString('en-US', { month: 'short', day: 'numeric', timeZone: tz }),
                fullDate:  dt.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric', timeZone: tz }),
                atVs:      isHome ? 'vs' : '@',
                opponent:  opp.name,
                logoId:    opp.id,
                teamLogoId: TEAM,
                venueName: g.venue?.name ?? '',
                time:      dt.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', timeZone: tz }) + ' ' + tzSuffix,
                tv:        g.content?.media?.epg?.[0]?.items?.[0]?.callSign ?? '',
                isHome,
                gamePk:    g.gamePk,
                isoDate:   dt.toLocaleDateString('en-CA', { timeZone: tz }),
                weekday:   dt.toLocaleDateString('en-US', { timeZone: tz, weekday: 'long' }),
              })
            }
          }
          if (games.length && _currentTeamKey === key) {
            TEAMS[key].schedule = games
            renderSchedule(games)
            renderNextGame(games[0])
          }
        }
      } catch (e) { console.warn('Schedule fetch failed', e) }

      /* ── Last game performers ── */
      try {
        const lsRes = await fetch(`https://statsapi.mlb.com/api/v1/schedule?teamId=${TEAM}&season=2025&sportId=1&gameType=R,F,D,L,W&startDate=2025-09-20&endDate=2025-11-10`)
        const lsData = await lsRes.json()

        let lastGame = null
        for (const d of [...(lsData.dates ?? [])].reverse()) {
          const fin = d.games.filter(g => g.status.abstractGameState === 'Final')
          if (fin.length) { lastGame = fin[fin.length - 1]; break }
        }
        if (!lastGame) return

        const bsRes = await fetch(`https://statsapi.mlb.com/api/v1/game/${lastGame.gamePk}/boxscore`)
        const bs = await bsRes.json()

        const isHome  = lastGame.teams.home.team.id === TEAM
        const mySide  = isHome ? 'home' : 'away'
        const oppSide = isHome ? 'away' : 'home'
        const oppAbbr = lastGame.teams[oppSide].team.abbreviation ?? lastGame.teams[oppSide].team.name.split(' ').pop()
        const myScore = lastGame.teams[mySide].score
        const oppScore= lastGame.teams[oppSide].score
        const players = bs.teams[mySide].players

        const batters = Object.values(players)
          .filter(p => (p.stats?.batting?.atBats ?? 0) > 0)
          .sort((a, b) => {
            const hd = (b.stats.batting.hits ?? 0) - (a.stats.batting.hits ?? 0)
            return hd !== 0 ? hd : (b.stats.batting.rbi ?? 0) - (a.stats.batting.rbi ?? 0)
          })

        const wp = Object.values(players).find(p => (p.stats?.pitching?.wins ?? 0) > 0)
        const performers = []

        for (const p of batters.slice(0, 3)) {
          const s = p.stats.batting
          const parts = [`${s.hits}-${s.atBats}`]
          if (s.homeRuns > 0) parts.push('HR')
          else if (s.doubles > 0) parts.push('2B')
          if (s.rbi > 0) parts.push(`${s.rbi} RBI`)
          if (s.baseOnBalls > 0 && parts.length < 4) parts.push('BB')
          performers.push({ role: 'Batter', name: p.person.fullName, line: parts.join(' · ') })
        }
        if (wp) {
          const s = wp.stats.pitching
          performers.push({ role: 'Pitcher', name: wp.person.fullName,
            line: `${s.inningsPitched} IP · ${s.earnedRuns} ER · ${s.strikeOuts} K · W` })
        }

        if (performers.length && _currentTeamKey === key) {
          const gd = new Date(lastGame.gameDate)
          const mo = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']
          TEAMS[key].lastGame     = `${t.teamAbbr} ${myScore}, ${oppAbbr} ${oppScore}`
          TEAMS[key].lastGameDate = `${mo[gd.getMonth()]} ${gd.getDate()}, ${gd.getFullYear()}`
          TEAMS[key].performers   = performers
          document.querySelector('.performers-date').textContent = TEAMS[key].lastGameDate
          renderLgScore(TEAMS[key].lastGame)
          document.querySelector('.performers').innerHTML = performers.map(p => `
            <div class="performer">
              <span class="p-name">${p.name}</span>
              <span class="p-line">${p.line}</span>
            </div>`).join('')
        }
      } catch (e) { console.warn('Last game fetch failed', e) }
    }

    /* ── View switching ─────────────────────────────────── */
    let _currentView = 'home'

    function switchView(view) {
      _currentView = view
      localStorage.setItem('activeView', view)
      closePanel()
      // Toggle left sidebar — only visible on home view
      document.body.classList.toggle('no-left-sidebar', view !== 'home')
      const allViews = ['home','live','depth','contracts']
      allViews.forEach(v => {
        const el = document.getElementById(`view-${v}`)
        if (el) el.classList.toggle('active', v === view)
      })
      if (view === 'live' && _lastLiveData) renderFullLiveGame(_lastLiveData)
      if (view === 'depth') loadDepthChart()
      if (view === 'contracts') loadContracts(_currentTeamKey)
      // Update right-nav active state
      document.querySelectorAll('.rn-item[data-view]').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.view === view)
      })
      _setMobTab(view)
    }
    function _setMobTab(view) {
      // Only 3 tabs now: mobtab-live, mobtab-home, mobtab-more
      document.querySelectorAll('.mob-tab, .mob-tab-center').forEach(b => b.classList.remove('active'))
      if (view === 'live') {
        const t = document.getElementById('mobtab-live')
        if (t) t.classList.add('active')
      } else if (view === 'home') {
        const t = document.getElementById('mobtab-home')
        if (t) t.classList.add('active')
      } else {
        // depth, contracts, il, schedule, roster -> highlight "More"
        const t = document.getElementById('mobtab-more')
        if (t) t.classList.add('active')
      }
    }

    /* ── Live Game Tracker ───────────────────────────────── */
    const LOGO = 'https://www.mlbstatic.com/team-logos/team-cap-on-dark'

    async function startLiveTracker() {
      const today = new Date().toLocaleDateString('en-CA') // YYYY-MM-DD local
      try {
        const liveTeamId = TEAMS[_currentTeamKey]?.id ?? 119
        const res  = await fetch(`https://statsapi.mlb.com/api/v1/schedule?sportId=1&teamId=${liveTeamId}&date=${today}`)
        const data = await res.json()
        const game = data.dates?.[0]?.games?.[0]
        if (!game) return
        _liveGamePk = game.gamePk
        const state = game.status.abstractGameState
        if (state === 'Live' || state === 'Final') {
          await updateLiveGame()
          if (state === 'Live') _liveTimer = setInterval(updateLiveGame, 2000)
        }
      } catch(e) { console.warn('Live tracker:', e) }
    }

    async function updateLiveGame() {
      if (!_liveGamePk) return
      try {
        const res  = await fetch(`https://statsapi.mlb.com/api/v1.1/game/${_liveGamePk}/feed/live`)
        const data = await res.json()
        renderLiveGame(data)
      } catch(e) {}
    }

    function renderLiveGame(data) {
      _lastLiveData = data
      const card = document.getElementById('live-game-card')
      if (!card) return

      const gs    = data.gameData.status
      const ls    = data.liveData.linescore
      const away  = data.gameData.teams.away.team
      const home  = data.gameData.teams.home.team
      const isLive  = gs.abstractGameState === 'Live'
      const isFinal = gs.abstractGameState === 'Final'

      // Show/hide LIVE badge in sidebar nav + mobile tab dot
      const sbBadge = document.getElementById('sb-live-badge')
      if (sbBadge) sbBadge.style.display = isLive ? 'inline' : 'none'
      const mobDot = document.getElementById('mob-live-dot')
      if (mobDot) mobDot.style.display = isLive ? 'block' : 'none'

      const awayRuns = ls.teams?.away?.runs ?? 0
      const homeRuns = ls.teams?.home?.runs ?? 0
      const inning   = ls.currentInning ?? 1
      const isTop    = ls.isTopInning ?? true

      const balls   = ls.balls   ?? 0
      const strikes = ls.strikes ?? 0
      const outs    = ls.outs    ?? 0

      const first  = !!ls.offense?.first
      const second = !!ls.offense?.second
      const third  = !!ls.offense?.third

      const batter  = data.liveData.plays?.currentPlay?.matchup?.batter?.fullName  ?? ''
      const pitcher = data.liveData.plays?.currentPlay?.matchup?.pitcher?.fullName ?? ''
      const lastPlay = data.liveData.plays?.currentPlay?.result?.description ?? ''

      const inningStr = isFinal
        ? 'Final'
        : `${isTop ? '▲' : '▼'}\u00a0${inning}`

      const awayBatting = isLive && isTop
      const homeBatting = isLive && !isTop

      function dots(count, max, cls) {
        return Array.from({length: max}, (_,i) =>
          `<span class="count-dot ${i < count ? cls : ''}"></span>`).join('')
      }

      card.style.display = 'block'
      card.innerHTML = `
        <div class="dash-card-header">
          <span class="dash-card-label">${isFinal ? 'Final Score' : 'Live Game'}</span>
          ${isLive ? '<span class="live-pill"><span class="live-dot"></span>LIVE</span>' : ''}
        </div>
        <div class="live-score">
          <div class="live-team">
            <img class="live-logo" src="${LOGO}/${away.id}.svg" alt="${away.abbreviation}">
            <span class="live-abbr">${away.abbreviation}</span>
            <span class="live-runs${awayBatting ? ' batting' : ''}">${awayRuns}</span>
          </div>
          <span class="live-inning">${inningStr}</span>
          <div class="live-team">
            <span class="live-runs${homeBatting ? ' batting' : ''}">${homeRuns}</span>
            <span class="live-abbr">${home.abbreviation}</span>
            <img class="live-logo" src="${LOGO}/${home.id}.svg" alt="${home.abbreviation}">
          </div>
        </div>
        ${isLive ? `
        <div class="live-details">
          <div class="live-bases-count">
            <div class="bases-wrap">
              <div class="base base-2b ${second ? 'on' : ''}"></div>
              <div class="base base-3b ${third  ? 'on' : ''}"></div>
              <div class="base base-1b ${first  ? 'on' : ''}"></div>
              <div class="base base-home"></div>
            </div>
            <div class="count-wrap">
              <div class="count-row"><span class="count-lbl">B</span>${dots(balls,   3, 'ball')}</div>
              <div class="count-row"><span class="count-lbl">S</span>${dots(strikes, 2, 'strike')}</div>
              <div class="count-row"><span class="count-lbl">O</span>${dots(outs,    2, 'out')}</div>
            </div>
          </div>
          ${batter  ? `<div class="live-matchup-row"><span class="live-role">AB</span><span class="live-player">${batter}</span></div>`  : ''}
          ${pitcher ? `<div class="live-matchup-row"><span class="live-role">P</span><span class="live-player">${pitcher}</span></div>` : ''}
          ${lastPlay ? `<div class="live-last-play">${lastPlay}</div>` : ''}
        </div>` : ''}
      `

      if (isFinal && _liveTimer) { clearInterval(_liveTimer); _liveTimer = null }

      // Also update the full live view if it's active
      if (_currentView === 'live') renderFullLiveGame(data)
    }

    /* ── Full Live Game View Renderer ────────────────────── */
    function renderFullLiveGame(data) {
      const el = document.getElementById('live-full-view')
      if (!el) return

      const gs      = data.gameData.status
      const ls      = data.liveData.linescore
      const away    = data.gameData.teams.away.team
      const home    = data.gameData.teams.home.team
      const isLive  = gs.abstractGameState === 'Live'
      const isFinal = gs.abstractGameState === 'Final'

      if (!isLive && !isFinal) {
        el.innerHTML = '<div class="lf-empty">No live game data available.</div>'
        return
      }

      const innings       = ls.innings ?? []
      const curInning     = ls.currentInning ?? 0
      const isTop         = ls.isTopInning ?? true
      const awayTotals    = ls.teams?.away ?? {}
      const homeTotals    = ls.teams?.home ?? {}

      const balls   = ls.balls   ?? 0
      const strikes = ls.strikes ?? 0
      const outs    = ls.outs    ?? 0

      const cp       = data.liveData.plays?.currentPlay
      const batter   = cp?.matchup?.batter?.fullName  ?? '—'
      const pitcher  = cp?.matchup?.pitcher?.fullName ?? '—'
      const pitchEvts = (cp?.playEvents ?? []).filter(e => e.isPitch)
      const allPlays  = (data.liveData.plays?.allPlays ?? []).slice().reverse()

      // -- Scoreboard HTML --
      const maxInn = Math.max(9, innings.length)
      const innHeaders = Array.from({length: maxInn}, (_, i) => {
        const n = i + 1
        const isCur = isLive && n === curInning
        return `<th${isCur ? ' class="lf-cur-inn"' : ''}>${n}</th>`
      }).join('')

      function innRow(side) {
        return Array.from({length: maxInn}, (_, i) => {
          const n = i + 1
          const inn = innings.find(x => x.num === n)
          const val = inn ? (inn[side]?.runs ?? '') : ''
          const isCur = isLive && n === curInning
          return `<td${isCur ? ' class="lf-cur-inn"' : ''}>${val !== '' ? val : (n <= (innings.length || 0) ? '0' : '')}</td>`
        }).join('')
      }

      const inningStr = isFinal ? 'FINAL' : `${isTop ? '▲' : '▼'} ${curInning}`

      const scoreboardHtml = `
        <div class="lf-scoreboard">
          <table class="lf-sb-table">
            <thead>
              <tr>
                <th>Team</th>
                ${innHeaders}
                <th>R</th><th>H</th><th>E</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><div class="lf-sb-team"><img class="lf-sb-logo" src="${LOGO}/${away.id}.svg" alt="${away.abbreviation}"><span>${away.abbreviation}</span></div></td>
                ${innRow('away')}
                <td><strong>${awayTotals.runs ?? 0}</strong></td>
                <td>${awayTotals.hits ?? 0}</td>
                <td>${awayTotals.errors ?? 0}</td>
              </tr>
              <tr>
                <td><div class="lf-sb-team"><img class="lf-sb-logo" src="${LOGO}/${home.id}.svg" alt="${home.abbreviation}"><span>${home.abbreviation}</span></div></td>
                ${innRow('home')}
                <td><strong>${homeTotals.runs ?? 0}</strong></td>
                <td>${homeTotals.hits ?? 0}</td>
                <td>${homeTotals.errors ?? 0}</td>
              </tr>
            </tbody>
          </table>
        </div>`

      // -- Strike zone SVG --
      const SVG_W = 180, SVG_H = 220
      const mapX = px => ((px + 1.5) / 3.0) * SVG_W
      const mapY = pz => SVG_H - ((pz - 0.5) / 4.5) * SVG_H

      // Determine zone bounds from first pitch or use defaults
      let szTop = 3.5, szBot = 1.5
      if (pitchEvts.length > 0) {
        const szT = pitchEvts[0].pitchData?.sz_top
        const szB = pitchEvts[0].pitchData?.sz_bot
        if (szT) szTop = parseFloat(szT)
        if (szB) szBot = parseFloat(szB)
      }

      const zx1 = mapX(-0.708), zx2 = mapX(0.708)
      const zy1 = mapY(szTop),  zy2 = mapY(szBot)
      const zw  = zx2 - zx1, zh = zy2 - zy1
      const thirdW = zw / 3, thirdH = zh / 3

      // Home plate polygon (bottom center)
      const plateX = SVG_W / 2
      const plateY = SVG_H - 8
      const platePts = `${plateX},${plateY - 10} ${plateX + 9},${plateY - 5} ${plateX + 9},${plateY} ${plateX - 9},${plateY} ${plateX - 9},${plateY - 5}`

      // Pitch color map
      const pitchColor = code => {
        switch (code) {
          case 'B': return '#4caf50'       // ball - green
          case 'C': return '#f44336'       // called strike - red
          case 'S': return '#ff9800'       // swinging strike - orange
          case 'F': return '#ffeb3b'       // foul - yellow
          case 'X': return '#2196f3'       // in play - blue
          default:  return '#9e9e9e'
        }
      }
      const pitchResultLabel = code => {
        switch(code) {
          case 'B': return 'Ball'
          case 'C': return 'Called Strike'
          case 'S': return 'Swinging Strike'
          case 'F': return 'Foul'
          case 'X': return 'In Play'
          default: return code
        }
      }
      const pitchResultClass = code => {
        if (code === 'B') return 'ball'
        if (code === 'C' || code === 'S') return 'strike'
        if (code === 'F') return 'foul'
        if (code === 'X') return 'inplay'
        return ''
      }

      const pitchDots = pitchEvts.map((e, i) => {
        const px = e.pitchData?.coordinates?.pX
        const pz = e.pitchData?.coordinates?.pZ
        if (px == null || pz == null) return ''
        const cx = mapX(px), cy = mapY(pz)
        const code = e.details?.code ?? ''
        const color = pitchColor(code)
        const isLast = i === pitchEvts.length - 1
        const r = isLast ? 8 : 5
        const num = i + 1
        return `<circle cx="${cx.toFixed(1)}" cy="${cy.toFixed(1)}" r="${r}" fill="${color}" fill-opacity="0.82" stroke="#fff" stroke-width="${isLast ? 1.5 : 0.8}" stroke-opacity="0.6"/>
${isLast ? `<text x="${cx.toFixed(1)}" y="${(cy + 4).toFixed(1)}" text-anchor="middle" font-size="8" font-family="Inter,sans-serif" font-weight="700" fill="#fff" stroke="none">${num}</text>` : ''}`
      }).join('\n')

      const zoneSvg = `<svg class="lf-zone-svg" width="${SVG_W}" height="${SVG_H}" xmlns="http://www.w3.org/2000/svg">
  <!-- background -->
  <rect width="${SVG_W}" height="${SVG_H}" fill="none"/>
  <!-- zone box -->
  <rect x="${zx1.toFixed(1)}" y="${zy1.toFixed(1)}" width="${zw.toFixed(1)}" height="${zh.toFixed(1)}" fill="rgba(255,255,255,0.04)" stroke="rgba(255,255,255,0.35)" stroke-width="1.5"/>
  <!-- 3x3 grid lines -->
  <line x1="${(zx1 + thirdW).toFixed(1)}" y1="${zy1.toFixed(1)}" x2="${(zx1 + thirdW).toFixed(1)}" y2="${zy2.toFixed(1)}" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
  <line x1="${(zx1 + thirdW * 2).toFixed(1)}" y1="${zy1.toFixed(1)}" x2="${(zx1 + thirdW * 2).toFixed(1)}" y2="${zy2.toFixed(1)}" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
  <line x1="${zx1.toFixed(1)}" y1="${(zy1 + thirdH).toFixed(1)}" x2="${zx2.toFixed(1)}" y2="${(zy1 + thirdH).toFixed(1)}" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
  <line x1="${zx1.toFixed(1)}" y1="${(zy1 + thirdH * 2).toFixed(1)}" x2="${zx2.toFixed(1)}" y2="${(zy1 + thirdH * 2).toFixed(1)}" stroke="rgba(255,255,255,0.15)" stroke-width="0.8"/>
  <!-- home plate -->
  <polygon points="${platePts}" fill="rgba(255,255,255,0.12)" stroke="rgba(255,255,255,0.4)" stroke-width="1.2"/>
  <!-- pitch dots -->
  ${pitchDots}
</svg>`

      // -- Count dots --
      function liveCountDots(count, max, cls) {
        return Array.from({length: max}, (_, i) =>
          `<span class="lf-count-dot ${i < count ? cls : ''}"></span>`).join('')
      }

      const countHtml = `
        <div class="lf-count-col">
          <div class="lf-count-row"><span class="lf-count-lbl">B</span>${liveCountDots(balls,   3, 'ball')}</div>
          <div class="lf-count-row"><span class="lf-count-lbl">S</span>${liveCountDots(strikes, 2, 'strike')}</div>
          <div class="lf-count-row"><span class="lf-count-lbl">O</span>${liveCountDots(outs,    2, 'out')}</div>
        </div>`

      // -- Pitch log rows --
      const pitchLogRows = pitchEvts.length === 0
        ? '<div style="font-size:0.65rem;color:rgba(255,255,255,0.2);padding:0.5rem 0;">No pitches yet</div>'
        : [...pitchEvts].reverse().map((e, ri) => {
            const idx = pitchEvts.length - ri
            const speed = e.pitchData?.startSpeed ? `${Math.round(e.pitchData.startSpeed)}` : '—'
            const type  = e.details?.type?.description ?? e.details?.description ?? '—'
            const code  = e.details?.code ?? ''
            const resCls = pitchResultClass(code)
            const resLbl = pitchResultLabel(code)
            return `<div class="lf-pitch-row">
              <span class="lf-pitch-num">${idx}</span>
              <span class="lf-pitch-speed">${speed}<small style="font-size:0.55rem;font-family:Inter,sans-serif;color:rgba(255,255,255,0.4)"> mph</small></span>
              <span class="lf-pitch-type">${type}</span>
              <span class="lf-pitch-result ${resCls}">${resLbl}</span>
            </div>`
          }).join('')

      // -- Play-by-play rows --
      const ppRows = allPlays.length === 0
        ? '<div class="lf-empty">No plays yet</div>'
        : allPlays.map(play => {
            const inn = play.about?.inning ?? ''
            const top = play.about?.isTopInning ?? true
            const innInd = inn ? `${top ? '▲' : '▼'}${inn}` : '—'
            const event = play.result?.event ?? ''
            const desc  = play.result?.description ?? ''
            return `<div class="lf-pp-row">
              <div class="lf-pp-inn">${innInd}</div>
              <div>
                <div class="lf-pp-event">${event}</div>
                <div class="lf-pp-desc">${desc}</div>
              </div>
            </div>`
          }).join('')

      el.innerHTML = `
        <div class="lf-header">
          <span class="lf-title">Live Game</span>
          ${isLive ? '<span class="lf-status"><span class="live-dot"></span>LIVE</span>' : ''}
          ${isFinal ? '<span style="font-size:0.65rem;font-weight:700;letter-spacing:0.15em;color:rgba(255,255,255,0.4)">FINAL</span>' : ''}
          <span style="font-family:\'Bebas Neue\',sans-serif;font-size:1.1rem;letter-spacing:0.06em;color:rgba(255,255,255,0.5);margin-left:auto">${inningStr}</span>
        </div>

        ${scoreboardHtml}

        <div class="lf-body">
          <!-- At-bat panel -->
          <div class="lf-at-bat">
            <div class="lf-at-bat-header">Current At-Bat</div>
            <div class="lf-matchup">
              <div class="lf-matchup-row"><span class="lf-role">AB</span><span class="lf-player-name">${batter}</span></div>
              <div class="lf-matchup-row"><span class="lf-role">P</span><span class="lf-player-name">${pitcher}</span></div>
            </div>
            <div class="lf-zone-count">
              <div class="lf-zone-wrap">${zoneSvg}</div>
              ${countHtml}
            </div>
            <div class="lf-pitch-log">
              <div class="lf-pitch-log-label">Pitch Log</div>
              ${pitchLogRows}
            </div>
          </div>

          <!-- Play-by-play -->
          <div class="lf-play-log">
            <div class="lf-play-log-header">Play-by-Play</div>
            <div class="lf-play-log-scroll">${ppRows}</div>
          </div>
        </div>`
    }

    /* ── Depth Chart ─────────────────────────────────────── */

    const DC_POS_ORDER = ['C','1B','2B','SS','3B','LF','CF','RF','DH']
    const DC_PIT_ORDER = ['SP','RP','CL']
    const DC_POS_NAMES = {
      'C':'Catcher','1B':'First Base','2B':'Second Base','SS':'Shortstop',
      '3B':'Third Base','LF':'Left Field','CF':'Center Field','RF':'Right Field',
      'DH':'Designated Hitter','SP':'Starting Pitcher','RP':'Relief Pitcher','CL':'Closer'
    }

    async function loadDepthChart() {
      if (_depthLoaded) return
      const gridPos = document.getElementById('dc-grid-pos')
      const gridPit = document.getElementById('dc-grid-pit')
      gridPos.innerHTML = '<div class="dc-loading">Loading depth chart…</div>'
      gridPit.innerHTML = ''

      try {
        const teamId = TEAMS[_currentTeamKey]?.id ?? 119
        const season = new Date().getFullYear()
        const res = await fetch(
          `https://statsapi.mlb.com/api/v1/teams/${teamId}/roster?rosterType=depthChart&season=${season}&hydrate=person`
        )
        const data = await res.json()
        const roster = data.roster ?? []

        // Group by position abbreviation, keeping depth order
        // Normalize "P" → "RP" so generic pitchers show as relievers
        const byPos = {}
        for (const entry of roster) {
          let abbr = entry.position?.abbreviation ?? entry.position?.code ?? '?'
          if (abbr === 'P') abbr = 'RP'
          if (!byPos[abbr]) byPos[abbr] = []
          byPos[abbr].push(entry)
        }
        // Sort each group by depth field
        for (const key of Object.keys(byPos)) {
          byPos[key].sort((a, b) => (a.depth ?? 99) - (b.depth ?? 99))
        }

        function renderCard(abbr) {
          const players = byPos[abbr]
          if (!players || players.length === 0) return ''
          const posName = DC_POS_NAMES[abbr] ?? abbr
          const playerRows = players.map((entry, i) => {
            const id      = entry.person?.id
            const name    = entry.person?.fullName ?? '—'
            const jersey  = entry.jerseyNumber ?? ''
            const posType = (entry.position?.type ?? '').replace(/'/g, "\\'")
            const safeName = name.replace(/'/g, "\\'")
            const clickAttr = id
              ? `onclick="openPlayerOverlay(${id},'${posType}','${jersey}','${safeName}','${abbr}')" style="cursor:pointer"`
              : ''
            const photo = id
              ? `<img class="dc-photo" src="https://img.mlbstatic.com/mlb-photos/image/upload/w_60,q_auto/v1/people/${id}/headshot/67/current" alt="${name}" onerror="this.parentNode.innerHTML='<span class=\\'dc-photo-fallback\\'>◉</span>'">`
              : '<span class="dc-photo-fallback">◉</span>'
            return `
              <div class="dc-player ${i === 0 ? 'dc-starter' : ''}" ${clickAttr}>
                <div class="dc-photo-wrap">${photo}</div>
                <div class="dc-player-info">
                  <div class="dc-player-name">${name}</div>
                </div>
                <span class="dc-depth-num">${i + 1}</span>
              </div>`
          }).join('')
          return `
            <div class="dc-card">
              <div class="dc-pos-header">
                <span class="dc-pos-abbr">${abbr}</span>
                <span class="dc-pos-name">${posName}</span>
              </div>
              <div class="dc-players">${playerRows}</div>
            </div>`
        }

        // Position players
        const posHtml = DC_POS_ORDER.map(renderCard).filter(Boolean).join('')
        gridPos.innerHTML = posHtml || '<div class="dc-loading">No data available.</div>'

        // Pitchers — combine any abbr not in POS_ORDER
        const pitAbbrs = [...DC_PIT_ORDER, ...Object.keys(byPos).filter(k => !DC_POS_ORDER.includes(k) && !DC_PIT_ORDER.includes(k))]
        const pitHtml = pitAbbrs.map(renderCard).filter(Boolean).join('')
        gridPit.innerHTML = pitHtml || '<div class="dc-loading">No data available.</div>'

        _depthLoaded = true
      } catch(e) {
        console.warn('Depth chart fetch failed:', e)
        gridPos.innerHTML = '<div class="dc-loading">Could not load depth chart.</div>'
      }
    }

    /* ── World Series Modal ──────────────────────────────── */
    const WS_INFO = {
      1955: {
        subtitle: 'Brooklyn Dodgers vs. New York Yankees',
        result: 'Dodgers win 4–3',
        mvp: 'Johnny Podres',
        venue: 'Ebbets Field · Yankee Stadium',
        desc: "Brooklyn's only World Series title after decades of heartbreak against the Yankees. Johnny Podres threw a shutout in Game 7, and Sandy Amoros made a stunning running catch in the 6th inning to preserve the lead — one of the most iconic defensive plays in baseball history.",
        wiki: '1955_World_Series'
      },
      1959: {
        subtitle: 'Los Angeles Dodgers vs. Chicago White Sox',
        result: 'Dodgers win 4–2',
        mvp: 'Larry Sherry',
        venue: 'LA Memorial Coliseum · Comiskey Park',
        desc: "Los Angeles' first championship after relocating from Brooklyn. Down 2–0 in the series, the Dodgers rallied to win four straight. Relief ace Larry Sherry appeared in four games and was unhittable down the stretch.",
        wiki: '1959_World_Series'
      },
      1963: {
        subtitle: 'Los Angeles Dodgers vs. New York Yankees',
        result: 'Dodgers win 4–0',
        mvp: 'Sandy Koufax',
        venue: 'Yankee Stadium · Dodger Stadium',
        desc: "A dominant sweep of the mighty Yankees. Sandy Koufax won Games 1 and 4 while striking out 23 batters across the series. The Dodgers' pitching staff held New York to just 4 runs total — one of the most commanding World Series performances ever.",
        wiki: '1963_World_Series'
      },
      1965: {
        subtitle: 'Los Angeles Dodgers vs. Minnesota Twins',
        result: 'Dodgers win 4–3',
        mvp: 'Sandy Koufax',
        venue: 'Dodger Stadium · Metropolitan Stadium',
        desc: "Sandy Koufax at his absolute peak. He pitched Games 5 and 7 on short rest, throwing a complete game shutout in the clincher. Koufax struck out 29 batters in the series in one of the greatest individual World Series performances in baseball history.",
        wiki: '1965_World_Series'
      },
      1981: {
        subtitle: 'Los Angeles Dodgers vs. New York Yankees',
        result: 'Dodgers win 4–2',
        mvp: 'Ron Cey · Pedro Guerrero · Steve Yeager',
        venue: 'Yankee Stadium · Dodger Stadium',
        desc: "Down 2–0, the Dodgers became the first NL team to come back from an 0–2 deficit to win the World Series. Three players shared the MVP award — Ron Cey, Pedro Guerrero, and Steve Yeager — in one of the most memorable comebacks in Fall Classic history.",
        wiki: '1981_World_Series'
      },
      1988: {
        subtitle: 'Los Angeles Dodgers vs. Oakland Athletics',
        result: 'Dodgers win 4–1',
        mvp: 'Orel Hershiser',
        venue: 'Dodger Stadium · Oakland Coliseum',
        desc: "Kirk Gibson, barely able to walk due to injuries, came off the bench to hit a walk-off pinch-hit home run off Dennis Eckersley in Game 1. His fist pump around the bases is one of the most iconic moments in sports history. Orel Hershiser then dominated the rest of the series.",
        wiki: '1988_World_Series'
      },
      2020: {
        subtitle: 'Los Angeles Dodgers vs. Tampa Bay Rays',
        result: 'Dodgers win 4–2',
        mvp: 'Corey Seager',
        venue: 'Globe Life Field (neutral site, Arlington TX)',
        desc: "Played in a bubble during the COVID-19 pandemic, the Dodgers ended a 32-year championship drought. Corey Seager hit .400 with 2 home runs. Clayton Kershaw finally got the ring that had eluded him, and Justin Turner's positive COVID test during the celebration made for a bittersweet night.",
        wiki: '2020_World_Series'
      },
      2024: {
        subtitle: 'Los Angeles Dodgers vs. New York Yankees',
        result: 'Dodgers win 4–1',
        mvp: 'Freddie Freeman',
        venue: 'Dodger Stadium · Yankee Stadium',
        desc: "Freddie Freeman delivered one of the most dramatic moments in World Series history — a walk-off grand slam in the 10th inning of Game 1 while battling a severe ankle injury. He finished hitting .400 with 12 RBI across the series to claim MVP honors in stunning fashion.",
        wiki: '2024_World_Series'
      },
      2025: {
        subtitle: 'Los Angeles Dodgers vs. Toronto Blue Jays',
        result: 'Dodgers win 4–3',
        mvp: 'Yoshinobu Yamamoto (3 W, 1.02 ERA)',
        venue: 'Dodger Stadium · Rogers Centre, Toronto',
        desc: "Called one of the greatest World Series of all time. Game 3 went 18 innings — the second-longest in Series history — before Freddie Freeman hit a walk-off home run for the second straight Fall Classic. The Blue Jays won Games 4 and 5 to take a 3–2 lead, but Yamamoto shut them down in Game 6 to force a decider. In Game 7, with Toronto two outs away from the title, Miguel Rojas tied it with a solo home run. Will Smith followed with the go-ahead shot in the 11th inning. Yamamoto — one day after throwing 96 pitches — came out of the bullpen to close it out, finishing the series with 3 wins and a 1.02 ERA to claim MVP. Game 7 drew over 51 million viewers across the US, Canada, and Japan.",
        wiki: '2025_World_Series'
      },
      // Mets championships
      1969: {
        subtitle: 'New York Mets vs. Baltimore Orioles',
        result: 'Mets win 4–1',
        mvp: 'Donn Clendenon',
        venue: 'Memorial Stadium · Shea Stadium',
        desc: "The original Miracle Mets. After being baseball's worst team since their 1962 expansion, the Mets surged from 9½ games back in mid-August to win the NL East, then swept the Braves in the NLCS. Facing the heavily favored Orioles, the Mets pulled off one of the biggest upsets in World Series history. Tom Seaver, Jerry Koosman, and a stellar outfield defense led the way as New York won four straight after dropping Game 1.",
        wiki: '1969_World_Series'
      },
      1986: {
        subtitle: 'New York Mets vs. Boston Red Sox',
        result: 'Mets win 4–3',
        mvp: 'Ray Knight',
        venue: 'Shea Stadium · Fenway Park',
        desc: "One of the most dramatic World Series ever played. Down to their last strike in Game 6, Mookie Wilson's grounder rolled through Bill Buckner's legs as the Mets tied the series. The Mets then rallied from a 3-run deficit in Game 7 to claim the title. Dwight Gooden, Ron Darling, and the high-octane Mets lineup had dominated the NL all season — the team went 108-54 during the regular season.",
        wiki: '1986_World_Series'
      },
    }

    function openWsModal(year) {
      const info = WS_INFO[year]
      if (!info) return
      document.getElementById('ws-modal-year').textContent = year
      document.getElementById('ws-modal-subtitle').textContent = info.subtitle
      document.getElementById('ws-modal-result').textContent = info.result
      document.getElementById('ws-modal-meta').innerHTML = `
        <div class="ws-modal-meta-row"><span class="ws-modal-meta-label">Opponent</span><span class="ws-modal-meta-value">${info.subtitle.split(' vs. ')[1] ?? '—'}</span></div>
        <div class="ws-modal-meta-row"><span class="ws-modal-meta-label">MVP</span><span class="ws-modal-meta-value">${info.mvp}</span></div>
        <div class="ws-modal-meta-row"><span class="ws-modal-meta-label">Venues</span><span class="ws-modal-meta-value">${info.venue}</span></div>
      `
      document.getElementById('ws-modal-desc').textContent = info.desc

      // Reset image
      const img = document.getElementById('ws-modal-img')
      const placeholder = document.getElementById('ws-modal-img-placeholder')
      img.style.display = 'none'
      img.src = ''
      placeholder.style.display = 'block'

      // Show modal
      document.getElementById('ws-backdrop').classList.add('open')
      document.getElementById('ws-modal').classList.add('open')
      document.body.style.overflow = 'hidden'

      // Fetch Wikipedia thumbnail
      fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${info.wiki}`)
        .then(r => r.json())
        .then(data => {
          if (data.thumbnail?.source) {
            img.src = data.thumbnail.source
            img.onload = () => { img.style.display = 'block'; placeholder.style.display = 'none' }
          }
        })
        .catch(() => {})
    }

    function closeWsModal() {
      document.getElementById('ws-backdrop').classList.remove('open')
      document.getElementById('ws-modal').classList.remove('open')
      document.body.style.overflow = ''
    }

    /* ── More Sheet ─────────────────────────────────────── */
    function openMoreSheet() {
      document.getElementById('mob-more-backdrop').classList.add('open')
      document.getElementById('mob-more-sheet').classList.add('open')
      document.body.style.overflow = 'hidden'
    }
    function closeMoreSheet() {
      document.getElementById('mob-more-backdrop').classList.remove('open')
      document.getElementById('mob-more-sheet').classList.remove('open')
      document.body.style.overflow = ''
    }

    /* ── Contracts & Payroll Data ───────────────────────── */
    const CONTRACTS = {
      dodgers: {
        payroll: 286,
        luxTax: 241,
        players: [
          { id: 660271, name: 'Shohei Ohtani',    pos: 'DH', aav: 46.0, total: 700, start: 2024, end: 2033 },
          { id: 605141, name: 'Mookie Betts',     pos: 'RF', aav: 30.4, total: 365, start: 2021, end: 2032 },
          { id: 808982, name: 'Y. Yamamoto',      pos: 'SP', aav: 27.1, total: 325, start: 2024, end: 2035 },
          { id: 518692, name: 'Freddie Freeman',  pos: '1B', aav: 27.0, total: 162, start: 2022, end: 2027 },
          { id: 607192, name: 'Tyler Glasnow',    pos: 'SP', aav: 19.4, total: 136, start: 2025, end: 2031 },
          { id: 657136, name: 'Will Smith',       pos: 'C',  aav: 16.0, total: 140, start: 2022, end: 2031 },
          { id: 606061, name: 'T. Hernández',     pos: 'LF', aav: 14.5, total: 29,  start: 2025, end: 2026 },
          { id: 669242, name: 'Tommy Edman',      pos: '2B', aav: 12.0, total: 48,  start: 2025, end: 2028 },
        ]
      },
      mets: {
        payroll: 322,
        luxTax: 241,
        players: [
          { id: 665742, name: 'Juan Soto',        pos: 'RF', aav: 51.0, total: 765, start: 2025, end: 2039 },
          { id: 596019, name: 'F. Lindor',        pos: 'SS', aav: 34.1, total: 341, start: 2022, end: 2031 },
          { id: 624413, name: 'Pete Alonso',      pos: '1B', aav: 27.0, total: 54,  start: 2025, end: 2026 },
          { id: 607680, name: 'Brandon Nimmo',    pos: 'LF', aav: 22.1, total: 162, start: 2023, end: 2030 },
          { id: 621244, name: 'Edwin Díaz',       pos: 'CL', aav: 20.4, total: 102, start: 2023, end: 2027 },
          { id: 669923, name: 'Kodai Senga',      pos: 'SP', aav: 15.0, total: 75,  start: 2024, end: 2028 },
          { id: 648717, name: 'Sean Manaea',      pos: 'SP', aav: 14.0, total: 28,  start: 2025, end: 2026 },
          { id: 678103, name: 'Mark Vientos',     pos: '3B', aav: 1.2,  total: 2.4, start: 2025, end: 2026 },
        ]
      }
    }

    function loadContracts(key) {
      if (_contractsLoaded) return
      _contractsLoaded = true
      const wrap = document.getElementById('contracts-wrap')
      if (!wrap) return
      const data = CONTRACTS[key]
      if (!data) { wrap.innerHTML = '<div class="dc-loading">No contract data available.</div>'; return }

      const t = TEAMS[key]
      const accentColor = key === 'mets' ? '#002D72' : '#003DA5'
      const maxAav = Math.max(...data.players.map(p => p.aav))
      const luxPct = Math.min(100, (data.luxTax / data.payroll) * 100)

      // Timeline years
      const minYear = Math.min(...data.players.map(p => p.start))
      const maxYear = Math.max(...data.players.map(p => p.end))
      const totalYears = maxYear - minYear + 1
      const yearLabels = Array.from({length: totalYears}, (_, i) => minYear + i)

      // Payroll bar: how much of total payroll is over lux tax
      const payrollPct = Math.min(100, (data.payroll / (data.payroll * 1.1)) * 100)
      const luxPctOfBar = Math.min(100, (data.luxTax / (data.payroll * 1.1)) * 100)

      wrap.innerHTML = `
        <div style="display:flex;align-items:baseline;justify-content:space-between;margin-bottom:1.5rem;">
          <div>
            <div class="dc-page-title">Contracts &amp; Payroll</div>
            <div class="dc-page-sub">${t.name} · 2026</div>
          </div>
        </div>

        <!-- Payroll Bar -->
        <div class="payroll-bar-wrap">
          <div class="payroll-bar-label">2026 Payroll vs. Luxury Tax Threshold</div>
          <div class="payroll-bar-track">
            <div class="payroll-bar" style="width:${payrollPct.toFixed(1)}%; background: linear-gradient(90deg, ${accentColor} 0%, rgba(0,82,204,0.8) 100%);">
            </div>
            <div class="payroll-marker" style="left:${luxPctOfBar.toFixed(1)}%">
              <span class="payroll-marker-label">CBT $${data.luxTax}M</span>
            </div>
          </div>
          <div class="payroll-totals">
            <div class="payroll-total-item">
              <span class="payroll-total-val">$${data.payroll}M</span>
              <span class="payroll-total-lbl">Total Payroll</span>
            </div>
            <div class="payroll-total-item" style="text-align:right">
              <span class="payroll-total-val" style="color:${data.payroll > data.luxTax ? 'rgba(220,60,40,0.9)' : 'rgba(100,200,100,0.9)'}">
                ${data.payroll > data.luxTax ? '+' : '-'}$${Math.abs(data.payroll - data.luxTax)}M
              </span>
              <span class="payroll-total-lbl">${data.payroll > data.luxTax ? 'Over CBT' : 'Under CBT'}</span>
            </div>
          </div>
        </div>

        <!-- Top Salaries Chart -->
        <div class="salary-chart">
          <div class="salary-chart-title">Top Salaries (AAV)</div>
          ${data.players.map(p => `
            <div class="salary-row">
              <span class="salary-pos">${p.pos}</span>
              <span class="salary-name">${p.name}</span>
              <div class="salary-bar-wrap">
                <div class="salary-bar" style="width:${((p.aav / maxAav) * 100).toFixed(1)}%; background:linear-gradient(90deg,${accentColor},rgba(0,82,204,0.7))"></div>
              </div>
              <span class="salary-val">$${p.aav}M</span>
            </div>`).join('')}
        </div>

        <!-- Contract Timeline -->
        <div class="contract-timeline">
          <div class="contract-timeline-title">Contract Timeline</div>
          <div class="ct-year-labels">
            ${yearLabels.map(y => `<span class="ct-year-label">${y}</span>`).join('')}
          </div>
          ${data.players.map(p => {
            const leftPct  = ((p.start - minYear) / totalYears) * 100
            const widthPct = ((p.end - p.start + 1) / totalYears) * 100
            return `
            <div class="ct-row">
              <span class="ct-name">${p.name}</span>
              <div class="ct-bar-wrap">
                <div class="ct-bar" style="left:${leftPct.toFixed(2)}%;width:${widthPct.toFixed(2)}%;background:linear-gradient(90deg,${accentColor},rgba(0,82,204,0.6))">
                  <span class="ct-bar-aav">$${p.aav}M</span>
                </div>
              </div>
            </div>`
          }).join('')}
        </div>
      `
    }

    // Restore last active view — must run after all let declarations above
    const savedView = localStorage.getItem('activeView')
    if (savedView && savedView !== 'home') switchView(savedView)
  </script>
  <script src="script.js"></script>

  <!-- Mobile bottom tab bar (3-tab) -->
  <nav class="mob-tabs" id="mob-tabs">
    <button class="mob-tab" id="mobtab-live" onclick="switchView('live')">
      <span class="mob-live-dot" id="mob-live-dot" style="display:none"></span>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
        <circle cx="12" cy="12" r="4" fill="currentColor" stroke="none"/>
        <path d="M6.3 6.3a8 8 0 0 0 0 11.4" stroke-opacity=".45"/>
        <path d="M17.7 17.7a8 8 0 0 0 0-11.4" stroke-opacity=".45"/>
      </svg>
      <span class="mob-tab-label">Live</span>
    </button>
    <button class="mob-tab-center" id="mobtab-home" onclick="switchView('home')">
      <img id="mob-center-logo" src="https://www.mlbstatic.com/team-logos/team-cap-on-dark/119.svg" alt="Home">
    </button>
    <button class="mob-tab" id="mobtab-more" onclick="openMoreSheet()">
      <svg viewBox="0 0 24 24" fill="currentColor" width="22" height="22">
        <circle cx="5"  cy="12" r="2"/>
        <circle cx="12" cy="12" r="2"/>
        <circle cx="19" cy="12" r="2"/>
      </svg>
      <span class="mob-tab-label">More</span>
    </button>
  </nav>

  <!-- More sheet backdrop + slide-up sheet -->
  <div class="mob-more-backdrop" id="mob-more-backdrop" onclick="closeMoreSheet()"></div>
  <div class="mob-more-sheet" id="mob-more-sheet">
    <div class="mob-more-handle"></div>
    <div class="mob-more-grid">
      <button class="mob-more-item" onclick="closeMoreSheet(); switchView('depth')">
        <svg viewBox="0 0 24 24" fill="currentColor" width="26" height="26">
          <rect x="4"    y="14" width="3.5" height="7"  rx="1"/>
          <rect x="10.25" y="9"  width="3.5" height="12" rx="1"/>
          <rect x="16.5" y="5"  width="3.5" height="16" rx="1"/>
        </svg>
        <span>Depth Chart</span>
      </button>
      <button class="mob-more-item" onclick="closeMoreSheet(); openSidePanel('schedule')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="26" height="26">
          <rect x="3" y="4" width="18" height="18" rx="2"/>
          <path d="M16 2v4M8 2v4M3 10h18"/>
        </svg>
        <span>Schedule</span>
      </button>
      <button class="mob-more-item" onclick="closeMoreSheet(); switchView('contracts')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="26" height="26">
          <rect x="2" y="5" width="20" height="14" rx="2"/>
          <path d="M2 10h20"/>
        </svg>
        <span>Contracts</span>
      </button>

      <button class="mob-more-item" onclick="closeMoreSheet(); openSidePanel('roster')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" width="26" height="26">
          <circle cx="12" cy="7" r="4"/>
          <path d="M4 21c0-4.4 3.6-8 8-8s8 3.6 8 8"/>
        </svg>
        <span>Roster</span>
      </button>
    </div>
  </div>

  <!-- WS Championship Modal -->
  <div class="ws-backdrop" id="ws-backdrop" onclick="closeWsModal()"></div>
  <div class="ws-modal" id="ws-modal">
    <div class="ws-modal-card" onclick="event.stopPropagation()">
      <div class="ws-modal-header">
        <div>
          <div class="ws-modal-year-num" id="ws-modal-year"></div>
          <div class="ws-modal-subtitle" id="ws-modal-subtitle"></div>
        </div>
        <button class="ws-modal-close" onclick="closeWsModal()">✕</button>
      </div>
      <div class="ws-modal-body">
        <div class="ws-modal-img-wrap">
          <img class="ws-modal-img" id="ws-modal-img" src="" alt="" />
          <span class="ws-modal-img-placeholder" id="ws-modal-img-placeholder">🏆</span>
        </div>
        <div class="ws-modal-details">
          <div class="ws-modal-result" id="ws-modal-result"></div>
          <div class="ws-modal-meta" id="ws-modal-meta"></div>
          <p class="ws-modal-desc" id="ws-modal-desc"></p>
        </div>
      </div>
    </div>
  </div>

</body>
</html>